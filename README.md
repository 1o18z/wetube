# wetube
## Wetube Clone built using NodeJS, Express, Mongo and ES6ðŸŒˆðŸ§šðŸ»â€â™€ï¸

---
&nbsp;
## â€¢ json

â€£ jsonì€ í”„ë¡œê·¸ëž˜ë¨¸ê°€ íŒŒì¼ì— ì •ë³´ë¥¼ ì €ìž¥í•˜ê¸° ìœ„í•´ ë§Œë“  ë°©ì‹ ì¤‘ í•˜ë‚˜ì´ë‹¤. 
(= node.jsì˜ ì •ë³´ ì €ìž¥)  
â€£ nodeJSì˜ json ì´ë¦„ì€ ë¬´ì¡°ê±´ package.jsonì´ë‹¤.  
â†’ package.jsonì€ ê·¸ëƒ¥ í…ìŠ¤íŠ¸ íŒŒì¼ì´ë¯€ë¡œ ìˆ˜ì •í•´ë„ ê´œì°®ìŒ  
â€£ npm ië¥¼ ì‹¤í–‰í•  ë•ŒëŠ” package.jsonì„ ë‹«ê³  ì‹¤í–‰í•˜ëŠ” ê±¸ ê¶Œìž¥í•œë‹¤.  
(npmì´ ìžë™ìœ¼ë¡œ package.jsonì„ ìˆ˜ì •í•´ì„œ ì—ëŸ¬ê°€ ë‚  ìˆ˜ë„)

â€¢ main : í”„ë¡œì íŠ¸ì˜ ëŒ€í‘œ íŒŒì¼ì´ ë¬´ì—‡ì¸ì§€ ì•Œë ¤ì£¼ëŠ” ê²ƒ  
â€¢ scripts : ì‹¤í–‰í•˜ê³  ì‹¶ì€ ê²ƒ  
â€¢ dependencies : ë‚´ í”„ë¡œì íŠ¸ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ í•„ìˆ˜ì ìœ¼ë¡œ ìžˆì–´ì•¼ í•˜ëŠ” ê²ƒ  
â€¢ devDependencies : dependenciesëŠ” í”„ë¡œì íŠ¸ë¥¼ ìœ„í•œ ê±°ë¼ë©´ devDependenciesëŠ” ê°œë°œìžë¥¼ ìœ„í•œ ê²ƒ  
(ê°œë°œì„ ë” íŽ¸ë¦¬í•˜ê²Œ í•˜ê¸° ìœ„í•œ)

## â€¢ node_modules  
â€£ npmìœ¼ë¡œ ì„¤ì¹˜í•œ ëª¨ë“  íŒ¨í‚¤ì§€ê°€ ì €ìž¥ë˜ëŠ” ê³³ì´ë‹¤. 

## â€¢ package-lock.json
â€£ íŒ¨í‚¤ì§€ê°€ ìˆ˜ì •ëëŠ”ì§€ í•´ì‹œê°’ìœ¼ë¡œ ì²´í¬í•´ì£¼ê³  ì•ˆì „í•˜ê²Œ ê´€ë¦¬í•´ì¤€ë‹¤.

â€£ node_modules ê³¼ package-lock.json ì§€ìš°ê³  npm i ì‹¤í–‰í•˜ë©´ ë‹¤ì‹œ ì„¤ì¹˜ë˜ë‹ˆ ì§€ì›Œì ¸ë„ ê±±ì • ë†‰!

## â€¢ babel  
â€£ ìš°ë¦¬ê°€ ìž‘ì„±í•œ ìµœì‹  ìžë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ëª¨ë‘ê°€ ì´í•´í•  ìˆ˜ ìžˆëŠ” ì•ˆì •ëœ ìžë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ë°”ê¿”ì¤€ë‹¤. 

## â€¢ babel.config.json  
â€£ preset : babelì„ ìœ„í•œ ì—„ì²­ ê±°ëŒ€í•œ í”ŒëŸ¬ê·¸ì¸  
â†’ ê°€ìž¥ ìœ ëª…í•œ ê±´ preset-env : ìµœì‹  ìžë°”ìŠ¤í¬ë¦½íŠ¸ êµ¬ë¬¸ ì‚¬ìš©í•  ìˆ˜ ìžˆê²Œ í•´ì¤Œ

## â€¢ server
â€£ 24ì‹œê°„ ë‚´ë‚´ ì˜¨ë¼ì¸ì— ì—°ê²°ëœ ì»´í“¨í„°ë¼ í•  ìˆ˜ ìžˆìŒ!  
â€£ í•­ìƒ ìš°ë¦¬ë¥¼ listeningí•˜ê³  ìžˆì–´ì•¼ í•œë‹¤.  

## â€¢ callback  
â€£ ì„œë²„ê°€ ì‹œìž‘ë  ë•Œ ìž‘ë™í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤.  
â€£ callback ìž‘ì„±í•˜ê¸° ì „ì— ì„œë²„ì—ê²Œ ì–´ë–¤ í¬íŠ¸ë¥¼ listeningí• ì§€ ì–˜ê¸°í•´ ì¤˜ì•¼ í•œë‹¤.

## â€¢ GET 
â€£ HTTP method

## â€¢ http request
â€£ ì›¹ì‚¬ì´íŠ¸ì— ì ‘ì†í•˜ê³  ì„œë²„ì— ì •ë³´ë¥¼ ë³´ë‚´ëŠ” ë°©ë²•ì´ë‹¤.

## â€¢ middleware  
â€£ ì¤‘ê°„ì— ìžˆëŠ” ì†Œí”„íŠ¸ì›¨ì–´  
â€£ middlewareëŠ” requestì™€ response ì‚¬ì´ì— ì¡´ìž¬í•œë‹¤.  
(= ë¸Œë¼ìš°ì €ê°€ requestí•œ ë‹¤ìŒ, ì‘ë‹µí•˜ê¸° ì „)  
â€£ ëª¨ë“  controllerëŠ” middleware  
â€£ í•˜ë‚˜ì˜ urlì—ë§Œ ì“¸ ìˆ˜ë„ ìžˆê³  ëª¨ë“  urlì— ì“¸ ìˆ˜ë„ ìžˆë‹¤.

## â€¢ app.use  
â€£ global middlewareë¥¼ ë§Œë“¤ ìˆ˜ ìžˆê²Œ í•´ì¤€ë‹¤.  
  (ì–´ëŠ URLì—ì„œë„ ìž‘ë™í•˜ëŠ” middleware)  
â€£ app.use ê°€ app.getë³´ë‹¤ ë’¤ì— ì˜¤ë©´ middlewareê°€ ìž‘ë™í•˜ì§€ ì•ŠëŠ”ë‹¤.  
â€£ app.useë¥¼ ìœ„ì—ë‹¤ ë‘ë©´ ëª¨ë“  routeì— ì ìš©ëœë‹¤.

## â€¢ morgan  
â€£ morgan í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´, ë‚´ê°€ ì„¤ì •í•œ ëŒ€ë¡œ middlewareë¥¼ return í•´ì¤€ë‹¤.  
â€£ morganì€ GET, path, status code ì´ ëª¨ë“  ì •ë³´ë¥¼ ê°€ì§€ê³  ìžˆë‹¤.  

## â€¢ Router
â€£ ì»¨íŠ¸ë¡¤ëŸ¬ì™€ URLì˜ ê´€ë¦¬ë¥¼ ì‰½ê²Œ í•´ì¤€ë‹¤.  
(= ë¯¸ë‹ˆ ì–´í”Œë¦¬ì¼€ì´ì…˜ ë§Œë“¤ì–´ ì¤Œ)


## â€¢ export
â€£ íŒŒì¼ì€ í•œ ê°€ì§€ default export ë°–ì— ê°€ì§ˆ ìˆ˜ ì—†ë‹¤.

## â€¢ pug
â€£ pugëŠ” í…œí”Œë¦¿ ì—”ì§„  
(= í…œí”Œë¦¿ì„ ì´ìš©í•´ ë·°ë¥¼ ë§Œë“œëŠ” ê±¸ ë„ì›€)  
â€£ íŒŒì¼ì„ ë°›ì•„ì„œ ëª¨ë‘ ì²´í¬í•˜ê³  ìžë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•œë‹¤.  
â€£ ê¹”ë”í•œ htmlì„ ìž‘ì„±í•˜ë„ë¡ í•´ì¤€ë‹¤.  
â€£ ìš°ë¦¬ì˜ htmlì— ìžë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ í¬í•¨ì‹œí‚¬ ìˆ˜ ìžˆë‹¤.  
â€£ ìš°ë¦¬ê°€ ë°˜ë³µí•˜ì§€ ì•Šì•„ë„ í•œ íŒŒì¼ë¡œ ëª¨ë“  í…œí”Œë¦¿ì„ ì—…ë°ì´íŠ¸ í•  ìˆ˜ ìžˆë‹¤.  
íƒœê·¸ë¥¼ ì“°ì§€ ì•Šì•„ë„ ë„ì–´ì“°ê¸°ì™€ íƒ­ìœ¼ë¡œ êµ¬ë¶„ ëœë‹¤.    
â€£ expressëŠ” ì´ë¯¸ í…œí”Œë¦¿ì„ ë Œë”ë§í•˜ë„ë¡ ì„¤ì •ë˜ì–´ ìžˆìœ¼ë¯€ë¡œ res.renderì„ ì´ìš©í•´ pug íŒŒì¼ì˜ ì´ë¦„ì„ ì „í•´ì£¼ë©´ ëœë‹¤.  
(-> const hi = (req,res) => res.render("íŒŒì¼ì´ë¦„"));  
â€£ server.jsì˜ @ì¤„ì„ í†µí•´ pugì˜ ê²½ë¡œ ì§€ì •í•´ì¤€ë‹¤.  
(= ë Œë”ë§í•  ë•Œ ì°¾ì•„ì•¼ í•  ê²½ë¡œ)    

ex) title pageTitle ì´ë ‡ê²Œ ì“°ë©´ ê·¸ëƒ¥ í…ìŠ¤íŠ¸ê°€ ë˜ì§€ë§Œ, title=pageTitleì´ë¼ ì“°ë©´ ë³€ìˆ˜ë¡œ ì¸ì‹  
(-> í•˜ì§€ë§Œ ë‹¤ë¥¸ textì™€ ì„žì–´ì„œ ì“¸ ë•ŒëŠ” #{pageTitle} ì‚¬ìš©)

## â€¢ Iteration  
â€£ elementsì˜ listë¥¼ ë³´ì—¬ì¤€ë‹¤.  
(each in ì´ëŸ°ê±°. ëŒ“ê¸€, ë¹„ë””ì˜¤ ë“± ë¦¬ìŠ¤íŠ¸ ë³´ì—¬ì¤„ ë•Œ ì‚¬ìš©)  
â€£ in ë‹¤ìŒì— ì˜¤ëŠ” ë³€ìˆ˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ë³€ìˆ˜ ì´ë¦„ê³¼ ê°™ì•„ì•¼ í•œë‹¤.  

## â€¢ Mixin
â€£ mixinì€ partialì´ê¸´ í•œë° ë°ì´í„°ë¥¼ ë°›ì„ ìˆ˜ ìžˆëŠ” partial  
(= ë˜‘ë˜‘í•œ partial)  
â€£ ë°˜ë³µí•´ì„œ ë“±ìž¥í•˜ëŠ” HTML ë¸”ë¡ì´ í•„ìš”í•˜ê³ , ë¸”ë¡ í˜•íƒœë¥¼ ì§€ë‹ˆì§€ë§Œ ì„œë¡œ ë‹¤ë¥¸ ë°ì´í„°ë¥¼ ê°€ì ¸ì•¼ í•  ë•Œ ì‚¬ìš©í•œë‹¤.

## â€¢ watch.pug  
â€£ watch.pugì˜ a(href="/edit") ì¤„ì—ì„œ, ê·¸ëƒ¥ editì„ ì“°ë©´ /videos/editìœ¼ë¡œ ì´ë™í•˜ê³ , /editì„ ì¨ì•¼ /editìœ¼ë¡œ ì´ë™í•œë‹¤.  
=> absoluteì™€ relative urlì˜ ì°¨ì´ì   
ì•žì— /ë¥¼ ë„£ìœ¼ë©´, ë‚´ê°€ ì–´ë””ë“  ìƒê´€ ì—†ì´ rootê²½ë¡œ + /edit,  
/ë¥¼ ì§€ìš°ë©´ relative urlì´ ëœë‹¤. (í˜„ìž¬ ê²½ë¡œ ë’¤ì— /editì´ ë¶™ìŒ)    

ex) ì˜ˆë¥¼ ë“¤ì–´  a(href=`${video.id}/edit`)ë¼ê³  ì“°ë©´ localhost:4000/videos/3/edit ë¡œ ì´ë™í•˜ê³ , a(href=`/${video.id}/edit`)ë¼ê³  ì“°ë©´ localhost:4000/3/edit ë¡œ ì´ë™ 

(=> ê¸°ë³¸ê°’ìœ¼ë¡œ method="GET")  
â€£ GETì€ ì–¸ì œ ì“¸ê¹Œ?  
-> êµ¬ê¸€ì´ë‚˜ ë„¤ì´ë²„ì—ì„œ ë­”ê°€ë¥¼ ê²€ìƒ‰í•  ë•Œ, ê·¸ ê²€ìƒ‰ì–´ê°€ ì£¼ì†Œì°½ì— í¬í•¨ë˜ì–´ ìžˆì„ ê±°ìž„   
(ë¹„ë””ì˜¤ ê²€ìƒ‰í•˜ê±°ë‚˜ í•  ë•Œ ì‚¬ìš©)  
â€£ POSTëŠ” ì–¸ì œ ì“¸ê¹Œ?  
-> íŒŒì¼ ë³´ë‚´ê±°ë‚˜ databaseì— ìžˆëŠ” ê°’ì„ ë°”ê¾¸ëŠ” ë­”ê°€ë¥¼ ë³´ë‚¼ ë•Œ ì‚¬ìš©  
(ì›¹ì‚¬ì´íŠ¸ì— ë¡œê·¸ì¸ í•  ë•Œë„ POST ì‚¬ìš©)  


## â€¢ edit.pug  
â€£ inputì— nameì„ ë„£ì–´ì£¼ì§€ ì•Šìœ¼ë©´ req.bodyì—ì„œ ë°ì´í„°ë¥¼ ë³¼ ìˆ˜ ì—†ë‹¤.  

## â€¢ MongoDB  
â€£ ê°„ë‹¨í•˜ê²Œ ìž‘ë™ì‹œí‚¬ ìˆ˜ ìžˆê³  ì´ˆë³´ìžë“¤ë„ ì‚¬ìš© ê°€ëŠ¥  
ë¬¸ì„œê¸°ë°˜ì´ë‹¤.(document-based database)  
â€£ databaseë„ objectë¡œ ìƒê°í•œë‹¤.  
â€£ JSON-like-documentë¡œ ì €ìž¥í•  ìˆ˜ ìžˆê¸° ë•Œë¬¸ì—, ì´ˆì‹¬ìžë“¤ë„ ì‚¬ìš©í•˜ê¸° ì‰½ë‹¤.  


## â€¢ Mongoose  
â€£ node.jsì™€ mongoDBë¥¼ ì´ì–´ì£¼ëŠ” ë‹¤ë¦¬ ì—­í•   
(javascriptë¡œ ì ìœ¼ë©´, mongooseê°€ mongoDBì—ê²Œ ì „ë‹¬í•´ì¤Œ)  
â€£ mongoDBì™€ ìƒí˜¸ìž‘ìš©í•˜ê¸° ìœ„í•´ mongoose ì‚¬ìš©

â€£ onê³¼ onceì˜ ì°¨ì´ì   
-> onì€ ì—¬ëŸ¬ë²ˆ ê³„ì† ë°œìƒì‹œí‚¬ ìˆ˜ ìžˆë‹¤. (í´ë¦­ê°™ì€ ì´ë²¤íŠ¸)  
->onceëŠ” ì˜¤ë¡œì§€ í•œë²ˆë§Œ ë°œìƒí•œë‹¤.  

## â€¢ callback 
â€£ ë¬´ì–¸ê°€ê°€ ë°œìƒí•˜ê³  ë‚œ ë‹¤ìŒ í˜¸ì¶œë˜ëŠ” functionì„ ë§í•œë‹¤.  
â€£ callbackì„ ì‚¬ìš©í•˜ë©´ ì•„ë¬´ê²ƒë„ return ë˜ì§€ ì•Šì•„ì•¼ í•œë‹¤.  

ex) ì˜ˆë¥¼ ë“¤ì–´ ì•„ëž˜ì˜ ì½”ë“œë¥¼ ì‹¤í–‰ì‹œí‚¤ë©´
```
export const home = (req, res) =>{
  console.log("One")
  Video.find({}, (error, videos) => {
    console.log("Two")
  });
    console.log("Three");
}
```
```  
One
Three
Two
``` 
ìœ„ì²˜ëŸ¼ ì¶œë ¥ì´ ë˜ëŠ” ê±¸ ë³´ì•„, callbackì€ íŠ¹ì • ì½”ë“œë¥¼ ë§ˆì§€ë§‰ì— ì‹¤í–‰ë˜ê²Œ í•  ìˆ˜ ìžˆë‹¤.   
(= javascriptëŠ” ê¸°ë‹¤ë¦¬ëŠ” ê¸°ëŠ¥ì´ ì—†ë‹¤. ìœ„ì—ì„œë¶€í„° ìˆœì„œëŒ€ë¡œ ì‹¤í–‰í•œ ê±´ë° ìž‘ì—…ë³„ë¡œ ì‹œê°„ì´ ë‹¬ë¼ì„œ ìˆœì„œê°€ ë°”ë€ŒëŠ” ê±°) 

## â€¢ promise 
â€£ callbackì˜ ìµœì‹  ë²„ì „ì´ë¼ ë³¼ ìˆ˜ ìžˆë‹¤.  
â€£ awaitë¥¼ ì•žì— ì ìœ¼ë©´, findëŠ” ë‚´ê°€ callbackì„ í•„ìš”ë¡œ í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê±¸ ì•Œê²Œ ëœë‹¤.  
-> ë”°ë¼ì„œ findëŠ” ì°¾ì•„ë‚¸ ë¹„ë””ì˜¤ë¥¼ ë°”ë¡œ ì¶œë ¥í•´ì¤€ë‹¤.  

## â€¢ await  
â€£ awaitê°€ databaseë¥¼ ê¸°ë‹¤ë ¤ ì¤€ë‹¤.  
â€£ asyncì™€ awaitëŠ” javascriptê°€ ì–´ë””ì„œ ì–´ë–»ê²Œ ê¸°ë‹¤ë¦¬ëŠ”ì§€ ë°”ë¡œ ì•Œ ìˆ˜ ìžˆë‹¤.   
â€£ ì½”ë“œ ê·œì¹™ìƒ awaitëŠ” function ì•ˆì—ì„œë§Œ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ê³ , í•´ë‹¹ functionì´ asynchronousì¼ ë•Œë§Œ ê°€ëŠ¥í•˜ë‹¤.  
(=> ê·¸ëž˜ì„œ ì•žì— asyncë¼ê³  ì¨ì¤Œ)  
â€£ awaitì—ì„œ ì—ëŸ¬ê°€ ìƒê¸°ë©´ ë‹¤ ë‚ ì•„ê°€ ë²„ë¦¬ê³  ì•„ë¬´ê²ƒë„ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤.  

## â€¢ create  
```
 const video = new Video({
        title,
        description,
        createAt: Date.now(),
        hashtags: hashtags.split(",").map((word) => `#${word}`),
        meta:{
            views:0,
            rating:0,
        },
    });
    await video.save();
    return res.redirect("/");
```
ìœ„ ì½”ë“œì™€ ì•„ëž˜ ì½”ë“œì™€ ê°™ë‹¤.  
```
await Video.create({
        title,
        description,
        createAt: Date.now(),
        hashtags: hashtags.split(",").map((word) => `#${word}`),
        meta:{
            views:0,
            rating:0,
        },
    });
    return res.redirect("/");
})
```
-> ì•„ëž˜ ì½”ë“œëŠ” ìœ„ ì½”ë“œì™€ ê¸°ëŠ¥ì€ ê°™ì§€ë§Œ javascript objectë¥¼ ë§Œë“œëŠ” ê³¼ì •ì„ ìš°ë¦¬ê°€ í•˜ì§€ ì•Šì•„ë„ ëœë‹¤. (ìžë™ìœ¼ë¡œ í•´ì¤Œ)  
(=> ì¦‰, ë°©ì‹ì€ saveì™€ create ë°©ì‹ ë‘ ê°€ì§€ê°€ ìžˆë‹¤.)  

## â€¢ maxLength, minLength  
â€£ upload.pugì˜ inputì˜ max/minLengthì€ ì‚¬ìš©ìžë¥¼ ìœ„í•œ ê±°ê³ ,  
Video.jsì˜ max/minLengthëŠ” databaseë¥¼ ìœ„í•œ ê±°ë¡œ ë‘˜ ë‹¤ í•´ì¤˜ì•¼ í•œë‹¤.  

## â€¢ exists  
â€£ videoControlller.jsì˜ postEdit ë¶€ë¶„ì˜ findByIdë¥¼ existsë¡œ ë³€ê²½  
( => video objectë¥¼ ë°›ëŠ” ëŒ€ì‹  true, falseë¥¼ ë°›ê² ë‹¤ëŠ” ê²ƒ)   
-> postEditì—ì„œëŠ” ë‹¨ìˆœížˆ ì˜ìƒì´ ì¡´ìž¬í•˜ëŠ”ì§€ë§Œ í™•ì¸í•˜ë©´ ë˜ê¸° ë•Œë¬¸ì— existsë¡œ idë¥¼ ë°›ì§€ ì•Šê³ , filterë¥¼ ë°›ì•„ ì¡´ìž¬ ì—¬ë¶€ë¥¼ íŒë‹¨í•œë‹¤.     
â€£ ê·¸ëŸ¼ getEditë„ existsë¡œ ë°›ëŠ”ê²Œ ì¢‹ì„ê¹Œ?  
-> getEditì€ objectë¥¼ í†µí•´ edit templateë¡œ ë³´ë‚´ì¤˜ì•¼ í•˜ê¸° ë•Œë¬¸ì— video objectê°€ í•„ìš”í•˜ë¯€ë¡œ findById()ê°€ ë” ì í•©í•˜ë‹¤.  

## â€¢ middleware  
â€£ middlewareëŠ” ë¬´ì¡°ê±´ modelì´ ìƒì„±ë˜ê¸° ì „ì— ë§Œë“¤ì–´ì•¼ í•œë‹¤.    

## â€¢ db ë‚´ìš© ì‚­ì œ
-> [cmd]  
â€£  mongosh  
â€£  use wetube  
â€£  db.videos.remove({})  

form ë‚´ìš©ì€ req.body
idëŠ” req.params 
URLì˜ ì •ë³´ëŠ” req.query

## â€¢ schema  
â€£ schemaëŠ” validationì„ ìœ„í•œ ëª¨ë“  ê²ƒ   
â€£ static functionê³¼ middlewareë¥¼ ìƒì„±í•´ì„œ ì“¸ ìˆ˜ ìžˆë‹¤.  

## â€¢ DeprecationWarning
â€£ ì—ëŸ¬ ì•„ë‹˜!! ê²½ê³ !!  
â€£ ì˜¤ëž˜ëœ ê¸°ëŠ¥ì„ ì“°ê³  ìžˆìœ¼ë‹ˆê¹Œ ì—…ë°ì´íŠ¸ í•˜ë¼ê³  ì•Œë ¤ì£¼ëŠ” ê²½ê³   
(ì—¬ê¸°ì„œëŠ” userControllerì—ì„œ unique:true ì¨ì„œ ê²½ê³  ëœ¸)  
â€£ ê¼­ ê³ ì¹  í•„ìš”ëŠ” ì—†ì§€ë§Œ ê²½ê³  ëœ¨ì§€ ì•Šê²Œ í•˜ë ¤ê³  db.jsì— useCreateIndex:true ì¶”ê°€í•¨ (ìƒˆë¡œìš´ ë²„ì „ ì¶”ê°€í•˜ëŠ” ì½”ë“œ)

## â€¢ session  
â€£ ì„¸ì…˜ì€ ì„œë²„ì¸¡ì—ì„œ ì œê³µí•´ì£¼ëŠ” ë°ì´í„°
(= ë¸Œë¼ìš°ì €ë¥¼ ê¸°ì–µí•˜ëŠ” ë°©ì‹ ì¤‘ í•˜ë‚˜)  
â€£ ë°±ì—”ë“œì™€ ë¸Œë¼ìš°ì €ê°€ ì„œë¡œ ì •ë³´ë¥¼ ì•Œê³  ìžˆì–´ì•¼ í•œë‹¤.  
â€£ router ì•žì— ì´ˆê¸°í™”  
â€£ ì„œë²„ ì¢…ë£Œí–ˆë‹¤ê°€ ìž¬ì‹œìž‘í•˜ë©´ ì„¸ì…˜ ë‹¤ ì‚¬ë¼ì§„ë‹¤.  
-> expressê°€ ì„¸ì…˜ì„ ë©”ëª¨ë¦¬ì— ì €ìž¥í•˜ê³  ìžˆì–´ì„œ(ê³„ì† ìžŠì–´ë²„ë¦¼)   
â€£ ë¸Œë¼ìš°ì €ë§ˆë‹¤ ì„œë¡œ ë‹¤ë¥¸ ì„¸ì…˜  


## â€¢ session middleware  
â€£ storeë¼ëŠ” ì˜µì…˜ ì¡´ìž¬  
(-> defaultë¡œ ì„¤ì •ëœ ê²ƒê³¼ëŠ” ë‹¤ë¥¸ storeë¥¼ ì„¤ì •í•  ìˆ˜ ìžˆë‹¤ëŠ”)
 

â¥ middlewareëŠ” express-sessionë¼ëŠ” ëª¨ë“ˆë¡œë¶€í„° ì£¼ì–´ì§„ë‹¤.  
â¥ middlewareëŠ” ë¸Œë¼ìš°ì €ê°€ ìš°ë¦¬ì˜ backendì™€ ìƒí˜¸ìž‘ìš©í•  ë•Œë§ˆë‹¤ sessionì´ë¼ëŠ” middlewareê°€ ë¸Œë¼ìš°ì €ì— cookieë¥¼ ì „ì†¡í•œë‹¤.  
â¥ cookieëŠ” backendê°€ ë‚´ ë¸Œë¼ìš°ì €ì— ì£¼ëŠ” ì •ë³´ë¡œ, ì •í•´ì§„ ê·œì¹™ì´ ìžˆì–´ì„œ ë§¤ë²ˆ backendì— request í•  ë•Œ ë¸Œë¼ìš°ì €ëŠ” ì•Œì•„ì„œ ê·¸ requestì— cookieë¥¼ ë§ë¶™ì¸ë‹¤.(ë•Œë¬¸ì— ë‚´ê°€ ë”°ë¡œí•  ê²ƒì€ ì—†ìŒ)  
â¥ ë¸Œë¼ìš°ì €ëŠ” cookieë¡œ ë­˜ í• ì§€, ì–´ë””ì— ë„£ì„ì§€ ë‹¤ ì•Œê³ ìžˆë‹¤.  
â¥ ë¸Œë¼ìš°ì €ëŠ” ìš°ë¦¬ê°€ ë§¤ë²ˆ backend localhostì— ìžˆëŠ” URLë¡œ requestë¥¼ ë³´ë‚¼ ë•Œë§ˆë‹¤ cookieê°€ requestëž‘ ê°™ì´ ì „ì†¡ëœë‹¤.

## â€¢ cookie  
â€£ í´ë¼ì´ì–¸íŠ¸ì¸¡ì—ì„œ ì €ìž¥í•˜ê³  ì‚¬ìš©í•˜ëŠ” ë°ì´í„°  
â€£ cookieì—ëŠ” ì–´ë–¤ ì •ë³´ë“  ë„£ì„ ìˆ˜ ìžˆë‹¤.   
â€£ cookieë¥¼ ë°›ê³  ë³´ë‚´ëŠ” ê³¼ì •ì—ì„œ ì‚¬ìš©ìžëŠ” ì•„ë¬´ê²ƒë„ ì•ˆ í•´ë„ ëœë‹¤.(ìžë™ì ìœ¼ë¡œ í•´ì¤Œ)
â€£ session IDëŠ” cookieì— ì €ìž¥ë˜ì§€ë§Œ session dataëŠ” ì„œë²„ ìª½ì— ì €ìž¥ëœë‹¤.
â€£ ì„œë²„ì— ì €ìž¥ë˜ëŠ” default session storageëŠ” ì‹¤ì œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ìžˆëŠ” ê±´ ì•„ë‹ˆê³  MemoryStoreì´ë‹¤.
â€£ ì•„ë¬´ë¦¬ ì‚­ì œí•´ë„ ìƒˆë¡œê³ ì¹¨ í•  ë•Œë§ˆë‹¤ ì¿ í‚¤ëŠ” ìƒˆë¡œ ìƒì„±ë¨!!
â€£ ì‚¬ìš©ìžì—ê²Œ ì¿ í‚¤ë¥¼ ì£¼ê³ , sessionì€ DBì— ì €ìž¥

## â€¢ session store  
â€£ ìš°ë¦¬ê°€ sessionì„ ì €ìž¥í•˜ëŠ” ê³³  
â€£ ìš°ë¦¬ê°€ ë§¤ë²ˆ ì½”ë“œë¥¼ ì €ìž¥í•˜ë©´ ì„œë²„ ìž¬ì‹œìž‘ ë˜ëŠ”ë°, session storeëŠ” ì‚¬ë¼ì§
(í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì €ìž¥ì†Œ)


### â€£ ê·¸ëŸ¼ sessionì€ ì–´ë–»ê²Œ ë§Œë“¤ê¹Œ??  
=> ë¸Œë¼ìš°ì €ê°€ ìš°ë¦¬ì˜ backendë¥¼ ë°©ë¬¸í•  ë•Œ ë§Œë“¤ì–´ì§„ë‹¤.    
(íŽ˜ì´ì§€ ìƒˆë¡œê³ ì¹¨í•˜ê³  í„°ë¯¸ë„ì— db.sessions.find({}) ìž…ë ¥í•˜ë©´ sessionì´ ìƒê¸´ê±° í™•ì¸ ê°€ëŠ¥)  
-> db.jsì— 'store: MongoStore.create({mongoUrl:"mongodb://127.0.0.1:27017/wetube"})'ë¥¼ ì¶”ê°€í–ˆëŠ”ë°, ì´ë¡œ ì¸í•´ ì´ì œ ì„œë²„ë¥¼ ìž¬ì‹œìž‘ í•´ë„ DBì— ê¸°ì–µë˜ì–´ì§(ë¡œê·¸ì¸ ìƒíƒœ ìœ ì§€)!!!!! ì™€ìš°  
=> ì™œëƒë©´ ë”ì´ìƒ ë¡œê·¸ì¸ ì •ë³´ê°€ ì„œë²„ì— ìžˆì§€ ì•Šê³  MongoDBì— ìžˆì–´ì„œ!!  
(mongoDBì˜ store ì˜µì…˜ í•˜ë‚˜ë¡œ ì„¸ì…˜ì´ ì„œë²„ì— ì €ìž¥ë ì§€ mongoDBì— ì €ìž¥ë ì§€ ê²°ì • ë˜ëŠ”ê²Œ ë„ˆë¬´ ì‹ ê¸°í•˜ë‹¹.. store ì˜µì…˜ ì§€ìš°ë©´ ìž¬ì‹œìž‘ í•  ë•Œë§ˆë‹¤ ë©”ëª¨ë¦¬ ì§€ì›Œì§!!)

### â€¢ resave & saveUninitialized  
â€£ ìƒˆë¡œìš´ ì„¸ì…˜ì´ ìžˆëŠ”ë°, ìˆ˜ì •ëœ ì  ì—†ìœ¼ë©´ uninitialized(ì´ˆê¸°í™”ë˜ì§€ ì•Šì€)
â€£ sessionì€ í•œ ê³³ì—ì„œë§Œ ìˆ˜ì • ê°€ëŠ¥   
-> userControllerì˜
```
req.session.loggedIn = true;
req.session.user = user;
``` 
ìœ„ ë‘ ì¤„ì´ ìš°ë¦¬ê°€ ì‹¤ì œë¡œ sessionì„ initialize(ì´ˆê¸°í™”)í•˜ëŠ” ë¶€ë¶„  
â€£ sever.jsì— resaveì™€ saveUninitializedë¥¼ falseë¡œ í•´ì„œ ì´ì œ backendê°€ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìžì—ê²Œë§Œ cookieë¥¼ ì£¼ë„ë¡ ì„¤ì •ëë‹¤.

### â€¢ cookieì˜ property  
â€£ secret : ìš°ë¦¬ê°€ cookieì— signí•  ë•Œ ì‚¬ìš©í•˜ëŠ” string  
(ì¿ í‚¤ì— signí•˜ëŠ” ì´ìœ ? ìš°ë¦¬ backendê°€ cookieë¥¼ ì¤¬ë‹¤ëŠ” ê±¸ ë³´ì—¬ì£¼ê¸° ìœ„í•¨)  
secretì€ stringìœ¼ë¡œ ìž‘ì„±í•˜ëŠ”ë° ì“¸ ë•ŒëŠ” ê¸¸ê³  ì–´ë µê²Œ ë§Œë“¤ì–´ì•¼ í•œë‹¤.  
-> ì´ stringì„ ê°€ì§€ê³  cookieë¥¼ signí•˜ê³  ìš°ë¦¬ê°€ ë§Œë“  ê²ƒìž„ì„ ì¦ëª…í•  ìˆ˜ ìžˆìŒ  

â€£ Domain : ì´ cookieë¥¼ ë§Œë“  backendê°€ ëˆ„êµ¬ì¸ì§€ ì•Œë ¤ì¤€ë‹¤.  
ë¸Œë¼ìš°ì €ëŠ” Domainì— ë”°ë¼ cookieë¥¼ ì €ìž¥í•˜ë„ë¡ ë˜ì–´ ìžˆê³ ,  
cookieëŠ” Domainì— ìžˆëŠ” backendë¡œë§Œ ì „ì†¡ëœë‹¤.  
(Domainì€ cookieê°€ ì–´ë””ì„œ ì™”ëŠ”ì§€, ì–´ë””ë¡œ ê°€ì•¼í•˜ëŠ”ì§€ ì•Œë ¤ì¤Œ)  

â€£ path : ë‹¨ìˆœížˆ url  

â€£ Expires : HTTP íƒ€ìž„ìŠ¤íƒ¬í”„ë¡œ ê¸°ë¡ëœ cookieì˜ ìµœëŒ€ ìƒì¡´ ì‹œê°„(ìˆ˜ëª…) 
-> ë§Œë£Œ ë‚ ì§œë¥¼ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ sessoin cookieë¡œ ì„¤ì •ë˜ê³ , ì»´í“¨í„°ë¥¼ ìž¬ì‹œìž‘ í•˜ê±°ë‚˜ í”„ë¡œê·¸ëž¨ì„ ì¢…ë£Œí•˜ë©´ sessionì´ ì‚¬ë¼ì§  

â€£ Max-Age : sessionì´ ì–¸ì œ ë§Œë£Œë˜ëŠ”ì§€(ì–¼ë§ˆë™ì•ˆ ìœ ì§€í• ì§€) ì•Œë ¤ì£¼ëŠ” ê²ƒ  
-> server.jsì˜ session ì˜µì…˜ì— cookieë¥¼ ì´ìš©í•´ ë³€ê²½ ê°€ëŠ¥  
ex) cookie:{ maxAge: 20000} ì´ë¼í•˜ë©´, 20ì´ˆ ë’¤ì— session ì‚­ì œ


### â€¢ secret & store  
â€£ ë‹¤ë¥¸ ì‚¬ëžŒì´ ë³´ë©´ ì•ˆë¨(ë³´ì•ˆ ìœ„í—˜)  
-> .env íŒŒì¼ì„ ë§Œë“¤ì–´ì„œ ë¹„ë°€ë¡œ í•´ì•¼í•˜ëŠ” API key, url ë“±ì„ ë„£ì–´ì¤Œ

### â€¢ dotenv  
â€£ .env íŒŒì¼ì„ ì½ê³ , ê°ê°ì˜ ë³€ìˆ˜ë“¤ì„ process.env ì•ˆì— ë„£ëŠ”ë‹¤.  
â€£ íŒŒì´ì¬, ìžë°”ìŠ¤í¬ë¦½íŠ¸ ì™¸ì— ë‹¤ë¥¸ ì–¸ì–´ë¡œë„ êµ¬í˜„ë˜ì–´ ìžˆë‹¤.  
-> require("dotenv").config(); ì´ ì¤„ì€ ìµœëŒ€í•œ ê°€ìž¥ ë¨¼ì € ì¶”ê°€í•´ì¤˜ì•¼ í•œë‹¤.
(ì¶”ê°€í•˜ê³  ì½˜ì†”ë¡œ secretì´ëž‘ url ì°ì–´ë³´ë‹ˆê¹Œ undefinedê°€ ì•ˆ ëœ¨ê³  .env íŒŒì¼ì— ì ì–´ì¤€ ë‚´ìš©ì´ ì¶œë ¥ë¨!!)  

-> server.jsì— require("dotenv").config() ì¶”ê°€í•˜ê³  ì½˜ì†” ì°ìœ¼ë‹ˆê¹Œ ì ì€ ë‚´ìš©ì´ ìž˜ ì¶œë ¥ëëŠ”ë°, 'db.jsì— DB_URLì´ ì—†ë‹¤'ëŠ” ì—ëŸ¬ê°€ ì¶œë ¥ ëë‹¤  
-> ê·¸ëž˜ì„œ db.jsì—ì„œ ì½˜ì†” ì°ì—ˆëŠ”ë°ë„ ìž‘ë™í•˜ì§€ ì•ŠìŒ (undefinedê°€ ë‚˜ì˜´)
=> ì´ìœ ëŠ”?! require("dotenv").config()ë¥¼ ê°€ìž¥ ë¨¼ì € ì‹¤í–‰í•˜ì§€ ì•Šì•„ì„œë‹¤!!  
-> ë§¨ ìœ—ì¤„ì— ì ì—ˆëŠ”ë° ë¬´ìŠ¨ ì†Œë¦¬ì§€?
-> package.json íŒŒì¼ì— scriptsì˜ devë¥¼ ë³´ë©´, í”„ë¡œê·¸ëž¨ì„ ì‹¤í–‰í–ˆì„ ë•Œ init.jsê°€ ê°€ìž¥ ë¨¼ì € ì‹¤í–‰ë˜ê²Œ ë˜ì–´ìžˆë‹¤
-> ê·¸ëž˜ì„œ require("dotenv").config()ë¥¼ init.jsì˜ ë§¨ ìœ—ì¤„ë¡œ ì˜®ê²¨ì¤¬ë”ë‹ˆ í•´ê²°! ë˜ì–´ì•¼ í•˜ì§€ë§Œ ì•„ì§ë„ ìž‘ë™ë˜ì§€ ì•ŠëŠ”ë‹¤  
-> import ë°©ì‹ì´ ë‹¬ë¼ì„œ ê·¸ëŸ¼ (requireì´ë‚˜ import ë‘ ì¢…ë¥˜ë¡œ import í•´ì„œ)  
(require ë°©ì‹ì„ ì‚¬ìš©í•˜ê³  ì‹¶ìœ¼ë©´ dotenvë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ì€ ëª¨ë“  íŒŒì¼ì— requireì„ ì¶”ê°€í•´ì•¼ í•œë‹¤ -> ë„ˆë¬´ ë²ˆê±°ë¡œì›€)
=> require ë°©ì‹ì„ importë¡œ ìˆ˜ì •! => import "dotenv/config" 
=>> í•´ê²°!!!