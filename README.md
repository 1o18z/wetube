# wetube
## Wetube Clone built using NodeJS, Express, Mongo and ES6ğŸŒˆğŸ§šğŸ»â€â™€ï¸

---
&nbsp;
## â€¢ json

â€£ jsonì€ í”„ë¡œê·¸ë˜ë¨¸ê°€ íŒŒì¼ì— ì •ë³´ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•´ ë§Œë“  ë°©ì‹ ì¤‘ í•˜ë‚˜ì´ë‹¤. 
(= node.jsì˜ ì •ë³´ ì €ì¥)  
â€£ nodeJSì˜ json ì´ë¦„ì€ ë¬´ì¡°ê±´ package.jsonì´ë‹¤.  
â†’ package.jsonì€ ê·¸ëƒ¥ í…ìŠ¤íŠ¸ íŒŒì¼ì´ë¯€ë¡œ ìˆ˜ì •í•´ë„ ê´œì°®ìŒ  
â€£ npm ië¥¼ ì‹¤í–‰í•  ë•ŒëŠ” package.jsonì„ ë‹«ê³  ì‹¤í–‰í•˜ëŠ” ê±¸ ê¶Œì¥í•œë‹¤.  
(npmì´ ìë™ìœ¼ë¡œ package.jsonì„ ìˆ˜ì •í•´ì„œ ì—ëŸ¬ê°€ ë‚  ìˆ˜ë„)

â€¢ main : í”„ë¡œì íŠ¸ì˜ ëŒ€í‘œ íŒŒì¼ì´ ë¬´ì—‡ì¸ì§€ ì•Œë ¤ì£¼ëŠ” ê²ƒ  
â€¢ scripts : ì‹¤í–‰í•˜ê³  ì‹¶ì€ ê²ƒ  
â€¢ dependencies : ë‚´ í”„ë¡œì íŠ¸ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ í•„ìˆ˜ì ìœ¼ë¡œ ìˆì–´ì•¼ í•˜ëŠ” ê²ƒ  
â€¢ devDependencies : dependenciesëŠ” í”„ë¡œì íŠ¸ë¥¼ ìœ„í•œ ê±°ë¼ë©´ devDependenciesëŠ” ê°œë°œìë¥¼ ìœ„í•œ ê²ƒ  
(ê°œë°œì„ ë” í¸ë¦¬í•˜ê²Œ í•˜ê¸° ìœ„í•œ)

## â€¢ node_modules  
â€£ npmìœ¼ë¡œ ì„¤ì¹˜í•œ ëª¨ë“  íŒ¨í‚¤ì§€ê°€ ì €ì¥ë˜ëŠ” ê³³ì´ë‹¤. 

## â€¢ package-lock.json
â€£ íŒ¨í‚¤ì§€ê°€ ìˆ˜ì •ëëŠ”ì§€ í•´ì‹œê°’ìœ¼ë¡œ ì²´í¬í•´ì£¼ê³  ì•ˆì „í•˜ê²Œ ê´€ë¦¬í•´ì¤€ë‹¤.

â€£ node_modules ê³¼ package-lock.json ì§€ìš°ê³  npm i ì‹¤í–‰í•˜ë©´ ë‹¤ì‹œ ì„¤ì¹˜ë˜ë‹ˆ ì§€ì›Œì ¸ë„ ê±±ì • ë†‰!

## â€¢ babel  
â€£ ìš°ë¦¬ê°€ ì‘ì„±í•œ ìµœì‹  ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ëª¨ë‘ê°€ ì´í•´í•  ìˆ˜ ìˆëŠ” ì•ˆì •ëœ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ë°”ê¿”ì¤€ë‹¤. 

## â€¢ babel.config.json  
â€£ preset : babelì„ ìœ„í•œ ì—„ì²­ ê±°ëŒ€í•œ í”ŒëŸ¬ê·¸ì¸  
â†’ ê°€ì¥ ìœ ëª…í•œ ê±´ preset-env : ìµœì‹  ìë°”ìŠ¤í¬ë¦½íŠ¸ êµ¬ë¬¸ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ì¤Œ

## â€¢ server
â€£ 24ì‹œê°„ ë‚´ë‚´ ì˜¨ë¼ì¸ì— ì—°ê²°ëœ ì»´í“¨í„°ë¼ í•  ìˆ˜ ìˆìŒ!  
â€£ í•­ìƒ ìš°ë¦¬ë¥¼ listeningí•˜ê³  ìˆì–´ì•¼ í•œë‹¤.  

## â€¢ callback  
â€£ ì„œë²„ê°€ ì‹œì‘ë  ë•Œ ì‘ë™í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤.  
â€£ callback ì‘ì„±í•˜ê¸° ì „ì— ì„œë²„ì—ê²Œ ì–´ë–¤ í¬íŠ¸ë¥¼ listeningí• ì§€ ì–˜ê¸°í•´ ì¤˜ì•¼ í•œë‹¤.

## â€¢ GET 
â€£ HTTP method

## â€¢ http request
â€£ ì›¹ì‚¬ì´íŠ¸ì— ì ‘ì†í•˜ê³  ì„œë²„ì— ì •ë³´ë¥¼ ë³´ë‚´ëŠ” ë°©ë²•ì´ë‹¤.

## â€¢ middleware  
â€£ ì¤‘ê°„ì— ìˆëŠ” ì†Œí”„íŠ¸ì›¨ì–´  
â€£ middlewareëŠ” requestì™€ response ì‚¬ì´ì— ì¡´ì¬í•œë‹¤.  
(= ë¸Œë¼ìš°ì €ê°€ requestí•œ ë‹¤ìŒ, ì‘ë‹µí•˜ê¸° ì „)  
â€£ ëª¨ë“  controllerëŠ” middleware  
â€£ í•˜ë‚˜ì˜ urlì—ë§Œ ì“¸ ìˆ˜ë„ ìˆê³  ëª¨ë“  urlì— ì“¸ ìˆ˜ë„ ìˆë‹¤.

## â€¢ app.use  
â€£ global middlewareë¥¼ ë§Œë“¤ ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.  
  (ì–´ëŠ URLì—ì„œë„ ì‘ë™í•˜ëŠ” middleware)  
â€£ app.use ê°€ app.getë³´ë‹¤ ë’¤ì— ì˜¤ë©´ middlewareê°€ ì‘ë™í•˜ì§€ ì•ŠëŠ”ë‹¤.  
â€£ app.useë¥¼ ìœ„ì—ë‹¤ ë‘ë©´ ëª¨ë“  routeì— ì ìš©ëœë‹¤.

## â€¢ morgan  
â€£ morgan í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´, ë‚´ê°€ ì„¤ì •í•œ ëŒ€ë¡œ middlewareë¥¼ return í•´ì¤€ë‹¤.  
â€£ morganì€ GET, path, status code ì´ ëª¨ë“  ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆë‹¤.  

## â€¢ Router
â€£ ì»¨íŠ¸ë¡¤ëŸ¬ì™€ URLì˜ ê´€ë¦¬ë¥¼ ì‰½ê²Œ í•´ì¤€ë‹¤.  
(= ë¯¸ë‹ˆ ì–´í”Œë¦¬ì¼€ì´ì…˜ ë§Œë“¤ì–´ ì¤Œ)


## â€¢ export
â€£ íŒŒì¼ì€ í•œ ê°€ì§€ default export ë°–ì— ê°€ì§ˆ ìˆ˜ ì—†ë‹¤.

## â€¢ pug
â€£ pugëŠ” í…œí”Œë¦¿ ì—”ì§„  
(= í…œí”Œë¦¿ì„ ì´ìš©í•´ ë·°ë¥¼ ë§Œë“œëŠ” ê±¸ ë„ì›€)  
â€£ íŒŒì¼ì„ ë°›ì•„ì„œ ëª¨ë‘ ì²´í¬í•˜ê³  ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•œë‹¤.  
â€£ ê¹”ë”í•œ htmlì„ ì‘ì„±í•˜ë„ë¡ í•´ì¤€ë‹¤.  
â€£ ìš°ë¦¬ì˜ htmlì— ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ í¬í•¨ì‹œí‚¬ ìˆ˜ ìˆë‹¤.  
â€£ ìš°ë¦¬ê°€ ë°˜ë³µí•˜ì§€ ì•Šì•„ë„ í•œ íŒŒì¼ë¡œ ëª¨ë“  í…œí”Œë¦¿ì„ ì—…ë°ì´íŠ¸ í•  ìˆ˜ ìˆë‹¤.  
íƒœê·¸ë¥¼ ì“°ì§€ ì•Šì•„ë„ ë„ì–´ì“°ê¸°ì™€ íƒ­ìœ¼ë¡œ êµ¬ë¶„ ëœë‹¤.    
â€£ expressëŠ” ì´ë¯¸ í…œí”Œë¦¿ì„ ë Œë”ë§í•˜ë„ë¡ ì„¤ì •ë˜ì–´ ìˆìœ¼ë¯€ë¡œ res.renderì„ ì´ìš©í•´ pug íŒŒì¼ì˜ ì´ë¦„ì„ ì „í•´ì£¼ë©´ ëœë‹¤.  
(-> const hi = (req,res) => res.render("íŒŒì¼ì´ë¦„"));  
â€£ server.jsì˜ @ì¤„ì„ í†µí•´ pugì˜ ê²½ë¡œ ì§€ì •í•´ì¤€ë‹¤.  
(= ë Œë”ë§í•  ë•Œ ì°¾ì•„ì•¼ í•  ê²½ë¡œ)    

ex) title pageTitle ì´ë ‡ê²Œ ì“°ë©´ ê·¸ëƒ¥ í…ìŠ¤íŠ¸ê°€ ë˜ì§€ë§Œ, title=pageTitleì´ë¼ ì“°ë©´ ë³€ìˆ˜ë¡œ ì¸ì‹  
(-> í•˜ì§€ë§Œ ë‹¤ë¥¸ textì™€ ì„ì–´ì„œ ì“¸ ë•ŒëŠ” #{pageTitle} ì‚¬ìš©)

## â€¢ Iteration  
â€£ elementsì˜ listë¥¼ ë³´ì—¬ì¤€ë‹¤.  
(each in ì´ëŸ°ê±°. ëŒ“ê¸€, ë¹„ë””ì˜¤ ë“± ë¦¬ìŠ¤íŠ¸ ë³´ì—¬ì¤„ ë•Œ ì‚¬ìš©)  
â€£ in ë‹¤ìŒì— ì˜¤ëŠ” ë³€ìˆ˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ë³€ìˆ˜ ì´ë¦„ê³¼ ê°™ì•„ì•¼ í•œë‹¤.  

## â€¢ Mixin
â€£ mixinì€ partialì´ê¸´ í•œë° ë°ì´í„°ë¥¼ ë°›ì„ ìˆ˜ ìˆëŠ” partial  
(= ë˜‘ë˜‘í•œ partial)  
â€£ ë°˜ë³µí•´ì„œ ë“±ì¥í•˜ëŠ” HTML ë¸”ë¡ì´ í•„ìš”í•˜ê³ , ë¸”ë¡ í˜•íƒœë¥¼ ì§€ë‹ˆì§€ë§Œ ì„œë¡œ ë‹¤ë¥¸ ë°ì´í„°ë¥¼ ê°€ì ¸ì•¼ í•  ë•Œ ì‚¬ìš©í•œë‹¤.

## â€¢ watch.pug  
â€£ watch.pugì˜ a(href="/edit") ì¤„ì—ì„œ, ê·¸ëƒ¥ editì„ ì“°ë©´ /videos/editìœ¼ë¡œ ì´ë™í•˜ê³ , /editì„ ì¨ì•¼ /editìœ¼ë¡œ ì´ë™í•œë‹¤.  
=> absoluteì™€ relative urlì˜ ì°¨ì´ì   
ì•ì— /ë¥¼ ë„£ìœ¼ë©´, ë‚´ê°€ ì–´ë””ë“  ìƒê´€ ì—†ì´ rootê²½ë¡œ + /edit,  
/ë¥¼ ì§€ìš°ë©´ relative urlì´ ëœë‹¤. (í˜„ì¬ ê²½ë¡œ ë’¤ì— /editì´ ë¶™ìŒ)    

ex) ì˜ˆë¥¼ ë“¤ì–´  a(href=`${video.id}/edit`)ë¼ê³  ì“°ë©´ localhost:4000/videos/3/edit ë¡œ ì´ë™í•˜ê³ , a(href=`/${video.id}/edit`)ë¼ê³  ì“°ë©´ localhost:4000/3/edit ë¡œ ì´ë™ 

(=> ê¸°ë³¸ê°’ìœ¼ë¡œ method="GET")  
â€£ GETì€ ì–¸ì œ ì“¸ê¹Œ?  
-> êµ¬ê¸€ì´ë‚˜ ë„¤ì´ë²„ì—ì„œ ë­”ê°€ë¥¼ ê²€ìƒ‰í•  ë•Œ, ê·¸ ê²€ìƒ‰ì–´ê°€ ì£¼ì†Œì°½ì— í¬í•¨ë˜ì–´ ìˆì„ ê±°ì„   
(ë¹„ë””ì˜¤ ê²€ìƒ‰í•˜ê±°ë‚˜ í•  ë•Œ ì‚¬ìš©)  
â€£ POSTëŠ” ì–¸ì œ ì“¸ê¹Œ?  
-> íŒŒì¼ ë³´ë‚´ê±°ë‚˜ databaseì— ìˆëŠ” ê°’ì„ ë°”ê¾¸ëŠ” ë­”ê°€ë¥¼ ë³´ë‚¼ ë•Œ ì‚¬ìš©  
(ì›¹ì‚¬ì´íŠ¸ì— ë¡œê·¸ì¸ í•  ë•Œë„ POST ì‚¬ìš©)  


## â€¢ edit.pug  
â€£ inputì— nameì„ ë„£ì–´ì£¼ì§€ ì•Šìœ¼ë©´ req.bodyì—ì„œ ë°ì´í„°ë¥¼ ë³¼ ìˆ˜ ì—†ë‹¤.  

## â€¢ MongoDB  
â€£ ê°„ë‹¨í•˜ê²Œ ì‘ë™ì‹œí‚¬ ìˆ˜ ìˆê³  ì´ˆë³´ìë“¤ë„ ì‚¬ìš© ê°€ëŠ¥  
ë¬¸ì„œê¸°ë°˜ì´ë‹¤.(document-based database)  
â€£ databaseë„ objectë¡œ ìƒê°í•œë‹¤.  
â€£ JSON-like-documentë¡œ ì €ì¥í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì—, ì´ˆì‹¬ìë“¤ë„ ì‚¬ìš©í•˜ê¸° ì‰½ë‹¤.  


## â€¢ Mongoose  
â€£ node.jsì™€ mongoDBë¥¼ ì´ì–´ì£¼ëŠ” ë‹¤ë¦¬ ì—­í•   
(javascriptë¡œ ì ìœ¼ë©´, mongooseê°€ mongoDBì—ê²Œ ì „ë‹¬í•´ì¤Œ)  
â€£ mongoDBì™€ ìƒí˜¸ì‘ìš©í•˜ê¸° ìœ„í•´ mongoose ì‚¬ìš©

â€£ onê³¼ onceì˜ ì°¨ì´ì   
-> onì€ ì—¬ëŸ¬ë²ˆ ê³„ì† ë°œìƒì‹œí‚¬ ìˆ˜ ìˆë‹¤. (í´ë¦­ê°™ì€ ì´ë²¤íŠ¸)  
->onceëŠ” ì˜¤ë¡œì§€ í•œë²ˆë§Œ ë°œìƒí•œë‹¤.  

## â€¢ callback 
â€£ ë¬´ì–¸ê°€ê°€ ë°œìƒí•˜ê³  ë‚œ ë‹¤ìŒ í˜¸ì¶œë˜ëŠ” functionì„ ë§í•œë‹¤.  
â€£ callbackì„ ì‚¬ìš©í•˜ë©´ ì•„ë¬´ê²ƒë„ return ë˜ì§€ ì•Šì•„ì•¼ í•œë‹¤.  

ex) ì˜ˆë¥¼ ë“¤ì–´ ì•„ë˜ì˜ ì½”ë“œë¥¼ ì‹¤í–‰ì‹œí‚¤ë©´
```
export const home = (req, res) =>{
  console.log("One")
  Video.find({}, (error, videos) => {
    console.log("Two")
  });
    console.log("Three");
}
```
```  
One
Three
Two
``` 
ìœ„ì²˜ëŸ¼ ì¶œë ¥ì´ ë˜ëŠ” ê±¸ ë³´ì•„, callbackì€ íŠ¹ì • ì½”ë“œë¥¼ ë§ˆì§€ë§‰ì— ì‹¤í–‰ë˜ê²Œ í•  ìˆ˜ ìˆë‹¤.   
(= javascriptëŠ” ê¸°ë‹¤ë¦¬ëŠ” ê¸°ëŠ¥ì´ ì—†ë‹¤. ìœ„ì—ì„œë¶€í„° ìˆœì„œëŒ€ë¡œ ì‹¤í–‰í•œ ê±´ë° ì‘ì—…ë³„ë¡œ ì‹œê°„ì´ ë‹¬ë¼ì„œ ìˆœì„œê°€ ë°”ë€ŒëŠ” ê±°) 

## â€¢ promise 
â€£ callbackì˜ ìµœì‹  ë²„ì „ì´ë¼ ë³¼ ìˆ˜ ìˆë‹¤.  
â€£ awaitë¥¼ ì•ì— ì ìœ¼ë©´, findëŠ” ë‚´ê°€ callbackì„ í•„ìš”ë¡œ í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê±¸ ì•Œê²Œ ëœë‹¤.  
-> ë”°ë¼ì„œ findëŠ” ì°¾ì•„ë‚¸ ë¹„ë””ì˜¤ë¥¼ ë°”ë¡œ ì¶œë ¥í•´ì¤€ë‹¤.  

## â€¢ await  
â€£ awaitê°€ databaseë¥¼ ê¸°ë‹¤ë ¤ ì¤€ë‹¤.  
â€£ asyncì™€ awaitëŠ” javascriptê°€ ì–´ë””ì„œ ì–´ë–»ê²Œ ê¸°ë‹¤ë¦¬ëŠ”ì§€ ë°”ë¡œ ì•Œ ìˆ˜ ìˆë‹¤.   
â€£ ì½”ë“œ ê·œì¹™ìƒ awaitëŠ” function ì•ˆì—ì„œë§Œ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ê³ , í•´ë‹¹ functionì´ asynchronousì¼ ë•Œë§Œ ê°€ëŠ¥í•˜ë‹¤.  
(=> ê·¸ë˜ì„œ ì•ì— asyncë¼ê³  ì¨ì¤Œ)  
â€£ awaitì—ì„œ ì—ëŸ¬ê°€ ìƒê¸°ë©´ ë‹¤ ë‚ ì•„ê°€ ë²„ë¦¬ê³  ì•„ë¬´ê²ƒë„ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤.  

## â€¢ create  
```
 const video = new Video({
        title,
        description,
        createAt: Date.now(),
        hashtags: hashtags.split(",").map((word) => `#${word}`),
        meta:{
            views:0,
            rating:0,
        },
    });
    await video.save();
    return res.redirect("/");
```
ìœ„ ì½”ë“œì™€ ì•„ë˜ ì½”ë“œì™€ ê°™ë‹¤.  
```
await Video.create({
        title,
        description,
        createAt: Date.now(),
        hashtags: hashtags.split(",").map((word) => `#${word}`),
        meta:{
            views:0,
            rating:0,
        },
    });
    return res.redirect("/");
})
```
-> ì•„ë˜ ì½”ë“œëŠ” ìœ„ ì½”ë“œì™€ ê¸°ëŠ¥ì€ ê°™ì§€ë§Œ javascript objectë¥¼ ë§Œë“œëŠ” ê³¼ì •ì„ ìš°ë¦¬ê°€ í•˜ì§€ ì•Šì•„ë„ ëœë‹¤. (ìë™ìœ¼ë¡œ í•´ì¤Œ)  
(=> ì¦‰, ë°©ì‹ì€ saveì™€ create ë°©ì‹ ë‘ ê°€ì§€ê°€ ìˆë‹¤.)  

## â€¢ maxLength, minLength  
â€£ upload.pugì˜ inputì˜ max/minLengthì€ ì‚¬ìš©ìë¥¼ ìœ„í•œ ê±°ê³ ,  
Video.jsì˜ max/minLengthëŠ” databaseë¥¼ ìœ„í•œ ê±°ë¡œ ë‘˜ ë‹¤ í•´ì¤˜ì•¼ í•œë‹¤.  

## â€¢ exists  
â€£ videoControlller.jsì˜ postEdit ë¶€ë¶„ì˜ findByIdë¥¼ existsë¡œ ë³€ê²½  
( => video objectë¥¼ ë°›ëŠ” ëŒ€ì‹  true, falseë¥¼ ë°›ê² ë‹¤ëŠ” ê²ƒ)   
-> postEditì—ì„œëŠ” ë‹¨ìˆœíˆ ì˜ìƒì´ ì¡´ì¬í•˜ëŠ”ì§€ë§Œ í™•ì¸í•˜ë©´ ë˜ê¸° ë•Œë¬¸ì— existsë¡œ idë¥¼ ë°›ì§€ ì•Šê³ , filterë¥¼ ë°›ì•„ ì¡´ì¬ ì—¬ë¶€ë¥¼ íŒë‹¨í•œë‹¤.     
â€£ ê·¸ëŸ¼ getEditë„ existsë¡œ ë°›ëŠ”ê²Œ ì¢‹ì„ê¹Œ?  
-> getEditì€ objectë¥¼ í†µí•´ edit templateë¡œ ë³´ë‚´ì¤˜ì•¼ í•˜ê¸° ë•Œë¬¸ì— video objectê°€ í•„ìš”í•˜ë¯€ë¡œ findById()ê°€ ë” ì í•©í•˜ë‹¤.  

## â€¢ middleware  
â€£ middlewareëŠ” ë¬´ì¡°ê±´ modelì´ ìƒì„±ë˜ê¸° ì „ì— ë§Œë“¤ì–´ì•¼ í•œë‹¤.    

## â€¢ db ë‚´ìš© ì‚­ì œ
-> [cmd]  
â€£  mongosh  
â€£  use wetube  
â€£  db.videos.remove({})  

form ë‚´ìš©ì€ req.body
idëŠ” req.params 
URLì˜ ì •ë³´ëŠ” req.query

## â€¢ schema  
â€£ schemaëŠ” validationì„ ìœ„í•œ ëª¨ë“  ê²ƒ   
â€£ static functionê³¼ middlewareë¥¼ ìƒì„±í•´ì„œ ì“¸ ìˆ˜ ìˆë‹¤.  

## â€¢ DeprecationWarning
â€£ ì—ëŸ¬ ì•„ë‹˜!! ê²½ê³ !!  
â€£ ì˜¤ë˜ëœ ê¸°ëŠ¥ì„ ì“°ê³  ìˆìœ¼ë‹ˆê¹Œ ì—…ë°ì´íŠ¸ í•˜ë¼ê³  ì•Œë ¤ì£¼ëŠ” ê²½ê³   
(ì—¬ê¸°ì„œëŠ” userControllerì—ì„œ unique:true ì¨ì„œ ê²½ê³  ëœ¸)  
â€£ ê¼­ ê³ ì¹  í•„ìš”ëŠ” ì—†ì§€ë§Œ ê²½ê³  ëœ¨ì§€ ì•Šê²Œ í•˜ë ¤ê³  db.jsì— useCreateIndex:true ì¶”ê°€í•¨ (ìƒˆë¡œìš´ ë²„ì „ ì¶”ê°€í•˜ëŠ” ì½”ë“œ)

## â€¢ session  
â€£ ì„¸ì…˜ì€ ì„œë²„ì¸¡ì—ì„œ ì œê³µí•´ì£¼ëŠ” ë°ì´í„°
(= ë¸Œë¼ìš°ì €ë¥¼ ê¸°ì–µí•˜ëŠ” ë°©ì‹ ì¤‘ í•˜ë‚˜)  
â€£ ë°±ì—”ë“œì™€ ë¸Œë¼ìš°ì €ê°€ ì„œë¡œ ì •ë³´ë¥¼ ì•Œê³  ìˆì–´ì•¼ í•œë‹¤.  
â€£ router ì•ì— ì´ˆê¸°í™”  
â€£ ì„œë²„ ì¢…ë£Œí–ˆë‹¤ê°€ ì¬ì‹œì‘í•˜ë©´ ì„¸ì…˜ ë‹¤ ì‚¬ë¼ì§„ë‹¤.  
-> expressê°€ ì„¸ì…˜ì„ ë©”ëª¨ë¦¬ì— ì €ì¥í•˜ê³  ìˆì–´ì„œ(ê³„ì† ìŠì–´ë²„ë¦¼)   
â€£ ë¸Œë¼ìš°ì €ë§ˆë‹¤ ì„œë¡œ ë‹¤ë¥¸ ì„¸ì…˜  


## â€¢ session middleware  
â€£ storeë¼ëŠ” ì˜µì…˜ ì¡´ì¬  
(-> defaultë¡œ ì„¤ì •ëœ ê²ƒê³¼ëŠ” ë‹¤ë¥¸ storeë¥¼ ì„¤ì •í•  ìˆ˜ ìˆë‹¤ëŠ”)
 

â¥ middlewareëŠ” express-sessionë¼ëŠ” ëª¨ë“ˆë¡œë¶€í„° ì£¼ì–´ì§„ë‹¤.  
â¥ middlewareëŠ” ë¸Œë¼ìš°ì €ê°€ ìš°ë¦¬ì˜ backendì™€ ìƒí˜¸ì‘ìš©í•  ë•Œë§ˆë‹¤ sessionì´ë¼ëŠ” middlewareê°€ ë¸Œë¼ìš°ì €ì— cookieë¥¼ ì „ì†¡í•œë‹¤.  
â¥ cookieëŠ” backendê°€ ë‚´ ë¸Œë¼ìš°ì €ì— ì£¼ëŠ” ì •ë³´ë¡œ, ì •í•´ì§„ ê·œì¹™ì´ ìˆì–´ì„œ ë§¤ë²ˆ backendì— request í•  ë•Œ ë¸Œë¼ìš°ì €ëŠ” ì•Œì•„ì„œ ê·¸ requestì— cookieë¥¼ ë§ë¶™ì¸ë‹¤.(ë•Œë¬¸ì— ë‚´ê°€ ë”°ë¡œí•  ê²ƒì€ ì—†ìŒ)  
â¥ ë¸Œë¼ìš°ì €ëŠ” cookieë¡œ ë­˜ í• ì§€, ì–´ë””ì— ë„£ì„ì§€ ë‹¤ ì•Œê³ ìˆë‹¤.  
â¥ ë¸Œë¼ìš°ì €ëŠ” ìš°ë¦¬ê°€ ë§¤ë²ˆ backend localhostì— ìˆëŠ” URLë¡œ requestë¥¼ ë³´ë‚¼ ë•Œë§ˆë‹¤ cookieê°€ requestë‘ ê°™ì´ ì „ì†¡ëœë‹¤.

## â€¢ cookie  
â€£ í´ë¼ì´ì–¸íŠ¸ì¸¡ì—ì„œ ì €ì¥í•˜ê³  ì‚¬ìš©í•˜ëŠ” ë°ì´í„°  
â€£ cookieì—ëŠ” ì–´ë–¤ ì •ë³´ë“  ë„£ì„ ìˆ˜ ìˆë‹¤.   
â€£ cookieë¥¼ ë°›ê³  ë³´ë‚´ëŠ” ê³¼ì •ì—ì„œ ì‚¬ìš©ìëŠ” ì•„ë¬´ê²ƒë„ ì•ˆ í•´ë„ ëœë‹¤.(ìë™ì ìœ¼ë¡œ í•´ì¤Œ)  
â€£ session IDëŠ” cookieì— ì €ì¥ë˜ì§€ë§Œ session dataëŠ” ì„œë²„ ìª½ì— ì €ì¥ëœë‹¤.  
â€£ ì„œë²„ì— ì €ì¥ë˜ëŠ” default session storageëŠ” ì‹¤ì œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ìˆëŠ” ê±´ ì•„ë‹ˆê³  MemoryStoreì´ë‹¤.  
â€£ ì•„ë¬´ë¦¬ ì‚­ì œí•´ë„ ìƒˆë¡œê³ ì¹¨ í•  ë•Œë§ˆë‹¤ ì¿ í‚¤ëŠ” ìƒˆë¡œ ìƒì„±ë¨!!  
â€£ ì‚¬ìš©ìì—ê²Œ ì¿ í‚¤ë¥¼ ì£¼ê³ , sessionì€ DBì— ì €ì¥

## â€¢ session store  
â€£ ìš°ë¦¬ê°€ sessionì„ ì €ì¥í•˜ëŠ” ê³³  
â€£ ìš°ë¦¬ê°€ ë§¤ë²ˆ ì½”ë“œë¥¼ ì €ì¥í•˜ë©´ ì„œë²„ ì¬ì‹œì‘ ë˜ëŠ”ë°, session storeëŠ” ì‚¬ë¼ì§  
(í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì €ì¥ì†Œ)


### â€£ ê·¸ëŸ¼ sessionì€ ì–´ë–»ê²Œ ë§Œë“¤ê¹Œ??  
=> ë¸Œë¼ìš°ì €ê°€ ìš°ë¦¬ì˜ backendë¥¼ ë°©ë¬¸í•  ë•Œ ë§Œë“¤ì–´ì§„ë‹¤.    
(í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨í•˜ê³  í„°ë¯¸ë„ì— db.sessions.find({}) ì…ë ¥í•˜ë©´ sessionì´ ìƒê¸´ê±° í™•ì¸ ê°€ëŠ¥)  
-> db.jsì— 'store: MongoStore.create({mongoUrl:"mongodb://127.0.0.1:27017/wetube"})'ë¥¼ ì¶”ê°€í–ˆëŠ”ë°, ì´ë¡œ ì¸í•´ ì´ì œ ì„œë²„ë¥¼ ì¬ì‹œì‘ í•´ë„ DBì— ê¸°ì–µë˜ì–´ì§(ë¡œê·¸ì¸ ìƒíƒœ ìœ ì§€)!!!!! ì™€ìš°  
=> ì™œëƒë©´ ë”ì´ìƒ ë¡œê·¸ì¸ ì •ë³´ê°€ ì„œë²„ì— ìˆì§€ ì•Šê³  MongoDBì— ìˆì–´ì„œ!!  
(mongoDBì˜ store ì˜µì…˜ í•˜ë‚˜ë¡œ ì„¸ì…˜ì´ ì„œë²„ì— ì €ì¥ë ì§€ mongoDBì— ì €ì¥ë ì§€ ê²°ì • ë˜ëŠ”ê²Œ ë„ˆë¬´ ì‹ ê¸°í•˜ë‹¹.. store ì˜µì…˜ ì§€ìš°ë©´ ì¬ì‹œì‘ í•  ë•Œë§ˆë‹¤ ë©”ëª¨ë¦¬ ì§€ì›Œì§!!)

### â€¢ resave & saveUninitialized  
â€£ ìƒˆë¡œìš´ ì„¸ì…˜ì´ ìˆëŠ”ë°, ìˆ˜ì •ëœ ì  ì—†ìœ¼ë©´ uninitialized(ì´ˆê¸°í™”ë˜ì§€ ì•Šì€)  
â€£ sessionì€ í•œ ê³³ì—ì„œë§Œ ìˆ˜ì • ê°€ëŠ¥   
-> userControllerì˜
```
req.session.loggedIn = true;
req.session.user = user;
``` 
ìœ„ ë‘ ì¤„ì´ ìš°ë¦¬ê°€ ì‹¤ì œë¡œ sessionì„ initialize(ì´ˆê¸°í™”)í•˜ëŠ” ë¶€ë¶„  
â€£ sever.jsì— resaveì™€ saveUninitializedë¥¼ falseë¡œ í•´ì„œ ì´ì œ backendê°€ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì—ê²Œë§Œ cookieë¥¼ ì£¼ë„ë¡ ì„¤ì •ëë‹¤.

### â€¢ cookieì˜ property  
â€£ secret : ìš°ë¦¬ê°€ cookieì— signí•  ë•Œ ì‚¬ìš©í•˜ëŠ” string  
(ì¿ í‚¤ì— signí•˜ëŠ” ì´ìœ ? ìš°ë¦¬ backendê°€ cookieë¥¼ ì¤¬ë‹¤ëŠ” ê±¸ ë³´ì—¬ì£¼ê¸° ìœ„í•¨)  
secretì€ stringìœ¼ë¡œ ì‘ì„±í•˜ëŠ”ë° ì“¸ ë•ŒëŠ” ê¸¸ê³  ì–´ë µê²Œ ë§Œë“¤ì–´ì•¼ í•œë‹¤.  
-> ì´ stringì„ ê°€ì§€ê³  cookieë¥¼ signí•˜ê³  ìš°ë¦¬ê°€ ë§Œë“  ê²ƒì„ì„ ì¦ëª…í•  ìˆ˜ ìˆìŒ  

â€£ Domain : ì´ cookieë¥¼ ë§Œë“  backendê°€ ëˆ„êµ¬ì¸ì§€ ì•Œë ¤ì¤€ë‹¤.  
ë¸Œë¼ìš°ì €ëŠ” Domainì— ë”°ë¼ cookieë¥¼ ì €ì¥í•˜ë„ë¡ ë˜ì–´ ìˆê³ ,  
cookieëŠ” Domainì— ìˆëŠ” backendë¡œë§Œ ì „ì†¡ëœë‹¤.  
(Domainì€ cookieê°€ ì–´ë””ì„œ ì™”ëŠ”ì§€, ì–´ë””ë¡œ ê°€ì•¼í•˜ëŠ”ì§€ ì•Œë ¤ì¤Œ)  

â€£ path : ë‹¨ìˆœíˆ url  

â€£ Expires : HTTP íƒ€ì„ìŠ¤íƒ¬í”„ë¡œ ê¸°ë¡ëœ cookieì˜ ìµœëŒ€ ìƒì¡´ ì‹œê°„(ìˆ˜ëª…)   
-> ë§Œë£Œ ë‚ ì§œë¥¼ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ sessoin cookieë¡œ ì„¤ì •ë˜ê³ , ì»´í“¨í„°ë¥¼ ì¬ì‹œì‘ í•˜ê±°ë‚˜ í”„ë¡œê·¸ë¨ì„ ì¢…ë£Œí•˜ë©´ sessionì´ ì‚¬ë¼ì§  

â€£ Max-Age : sessionì´ ì–¸ì œ ë§Œë£Œë˜ëŠ”ì§€(ì–¼ë§ˆë™ì•ˆ ìœ ì§€í• ì§€) ì•Œë ¤ì£¼ëŠ” ê²ƒ  
-> server.jsì˜ session ì˜µì…˜ì— cookieë¥¼ ì´ìš©í•´ ë³€ê²½ ê°€ëŠ¥  
ex) cookie:{ maxAge: 20000} ì´ë¼í•˜ë©´, 20ì´ˆ ë’¤ì— session ì‚­ì œ


### â€¢ secret & store  
â€£ ë‹¤ë¥¸ ì‚¬ëŒì´ ë³´ë©´ ì•ˆë¨(ë³´ì•ˆ ìœ„í—˜)  
-> .env íŒŒì¼ì„ ë§Œë“¤ì–´ì„œ ë¹„ë°€ë¡œ í•´ì•¼í•˜ëŠ” API key, url ë“±ì„ ë„£ì–´ì¤Œ

### â€¢ dotenv  
â€£ .env íŒŒì¼ì„ ì½ê³ , ê°ê°ì˜ ë³€ìˆ˜ë“¤ì„ process.env ì•ˆì— ë„£ëŠ”ë‹¤.  
â€£ íŒŒì´ì¬, ìë°”ìŠ¤í¬ë¦½íŠ¸ ì™¸ì— ë‹¤ë¥¸ ì–¸ì–´ë¡œë„ êµ¬í˜„ë˜ì–´ ìˆë‹¤.  
-> require("dotenv").config(); ì´ ì¤„ì€ ìµœëŒ€í•œ ê°€ì¥ ë¨¼ì € ì¶”ê°€í•´ì¤˜ì•¼ í•œë‹¤.  
(ì¶”ê°€í•˜ê³  ì½˜ì†”ë¡œ secretì´ë‘ url ì°ì–´ë³´ë‹ˆê¹Œ undefinedê°€ ì•ˆ ëœ¨ê³  .env íŒŒì¼ì— ì ì–´ì¤€ ë‚´ìš©ì´ ì¶œë ¥ë¨!!)  

-> server.jsì— require("dotenv").config() ì¶”ê°€í•˜ê³  ì½˜ì†” ì°ìœ¼ë‹ˆê¹Œ ì ì€ ë‚´ìš©ì´ ì˜ ì¶œë ¥ëëŠ”ë°, 'db.jsì— DB_URLì´ ì—†ë‹¤'ëŠ” ì—ëŸ¬ê°€ ì¶œë ¥ ëë‹¤  
-> ê·¸ë˜ì„œ db.jsì—ì„œ ì½˜ì†” ì°ì—ˆëŠ”ë°ë„ ì‘ë™í•˜ì§€ ì•ŠìŒ (undefinedê°€ ë‚˜ì˜´)  
=> ì´ìœ ëŠ”?! require("dotenv").config()ë¥¼ ê°€ì¥ ë¨¼ì € ì‹¤í–‰í•˜ì§€ ì•Šì•„ì„œë‹¤!!  
-> ë§¨ ìœ—ì¤„ì— ì ì—ˆëŠ”ë° ë¬´ìŠ¨ ì†Œë¦¬ì§€?  
-> package.json íŒŒì¼ì— scriptsì˜ devë¥¼ ë³´ë©´, í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í–ˆì„ ë•Œ init.jsê°€ ê°€ì¥ ë¨¼ì € ì‹¤í–‰ë˜ê²Œ ë˜ì–´ìˆë‹¤  
-> ê·¸ë˜ì„œ require("dotenv").config()ë¥¼ init.jsì˜ ë§¨ ìœ—ì¤„ë¡œ ì˜®ê²¨ì¤¬ë”ë‹ˆ í•´ê²°! ë˜ì–´ì•¼ í•˜ì§€ë§Œ ì•„ì§ë„ ì‘ë™ë˜ì§€ ì•ŠëŠ”ë‹¤  
-> import ë°©ì‹ì´ ë‹¬ë¼ì„œ ê·¸ëŸ¼ (requireì´ë‚˜ import ë‘ ì¢…ë¥˜ë¡œ import í•´ì„œ)  
(require ë°©ì‹ì„ ì‚¬ìš©í•˜ê³  ì‹¶ìœ¼ë©´ dotenvë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ì€ ëª¨ë“  íŒŒì¼ì— requireì„ ì¶”ê°€í•´ì•¼ í•œë‹¤ -> ë„ˆë¬´ ë²ˆê±°ë¡œì›€)  
=> require ë°©ì‹ì„ importë¡œ ìˆ˜ì •!   
=> import "dotenv/config"   
=>> í•´ê²°!!!  

### â€¢ scope (ë¡œê·¸ì¸ ì¤‘ github ê°€ì ¸ì˜¬ ë•Œ ì‚¬ìš©)
â€£ Userì—ê²Œì„œ ì–¼ë§ˆë‚˜ ë§ì´ ì •ë³´ë¥¼ ì½ì–´ë‚´ê³  ì–´ë–¤ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ê²ƒì— ëŒ€í•œ ê²ƒ  
â€£ ë‚´ê°€ ì–´ë–¤ ì •ë³´ë¥¼ ìš”ì²­í•˜ëŠëƒì— ë”°ë¼ userëŠ” ìŠ¹ì¸ì„ ë°›ê²Œ ë˜ê³  githubëŠ” ë‚˜ì—ê²Œ ì •ë³´ë¥¼ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” í† í°ì„ ì¤€ë‹¤.  

### â€¢ fetch  
â€£ fetch('url')ë¡œ ë‹¤ë¥¸ ì„œë²„ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.  
(í•˜ì§€ë§Œ res.bodyì— ë‹´ê²¨ìˆëŠ” ë‚  ê²ƒì˜ urlë¡œëŠ” ì œëŒ€ë¡œ ëœ ê°ì²´ ë°›ì•„ì˜¬ ìˆ˜ X)  
-> ê·¸ë˜ì„œ .json í•¨ìˆ˜ê°€ responseì˜ ìŠ¤íŠ¸ë¦¼ì„ ê°€ì ¸ì™€ ëê¹Œì§€ ì½ê³ , res.bodyì˜ í…ìŠ¤íŠ¸ë¥¼ promiseì˜ í˜•íƒœë¡œ ë°˜í™˜í•œë‹¤.    
(promiseëŠ” ì£¼ë¡œ ì„œë²„ì—ì„œ ë°›ì•„ì˜¨ ë°ì´í„°ë¥¼ í™”ë©´ì— í‘œì‹œí•  ë•Œ ì‚¬ìš©)  
-> ë‹¤ë¥¸ ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ object í˜•ì‹ìœ¼ë¡œ ë°›ì•„ì˜¨ë‹¤.  
ex) {"coord":{"lon":139.01,"lat":35.02},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}]  

### â€¢ fetch 
â€£ ìš°ë¦¬ëŠ” fetchê°€ í•„ìš”í•œë° fetchëŠ” ì„œë²„ì—” ì—†ê³  ë¸Œë¼ìš°ì €ì—ë§Œ ì¡´ì¬í•˜ë‹ˆê¹Œ node-fetchë¼ëŠ” íŒ¨í‚¤ì§€ ì‚¬ìš©

### â€¢ Multer    
â€£ ìš°ë¦¬ê°€ íŒŒì¼ì„ ì—…ë¡œë“œí•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.  
-> editProfile.pugì˜ formì— enctype="multipart/form-data"ì¶”ê°€  
(= ìš°ë¦¬ formì´ ë‹¤ë¥´ê²Œ encodeë  ê±°ë€ ì˜ë¯¸.  
ì¨ì£¼ì§€ ì•Šìœ¼ë©´ multer ì œëŒ€ë¡œ ì‘ë™ ë†‰!)  
=> ì´ê²Œ íŒŒì¼ì„ ë°±ì—”ë“œë¡œ ë³´ë‚´ê¸° ìœ„í•´ í•„ìš”í•œ encoding type(enctype) 

â€£ userRouter.js
```
userRouter.route("/edit")
  .all(protectorMiddleware)
  .get(getEdit)
  .post(uploadFiles.single("avatar"), postEdit);
```
-> ì‚¬ìš©ìê°€ /editìœ¼ë¡œ formì„ ë³´ë‚´ë©´ inputìœ¼ë¡œ avatar íŒŒì¼ í•˜ë‚˜ ë°›ì•„ì„œ ê·¸ í´ë”ë¥¼ uploads í´ë”ì— ì €ì¥í•œ ë‹¤ìŒì— ê·¸ íŒŒì¼ ì •ë³´ë¥¼ postEditì— ì „ë‹¬  
(middlewareëŠ” ì‚¬ì§„ì„ ì‹œìŠ¤í…œì— ì €ì¥í•˜ê³ , req.fileì„ ì¶”ê°€í• ê±´ë°,  
ê·¸ëŸ¬ê³  ë‚˜ì„œ controller ì‹¤í–‰ì‹œí‚¤ë©´ req.fileê³¼ req.body ì‚¬ìš© ê°€ëŠ¥)  

=> req.fileì„ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì´ìœ ëŠ” postEdit ì „ì— Multerì„ ì‚¬ìš©í•´ì„œ!!

### â€¢ ì ˆëŒ€! DBì—ëŠ”! íŒŒì¼ì„! ì €ì¥í•˜ì§€! ì•ŠëŠ”ë‹¤!  
â€£ íŒŒì¼ì˜ ìœ„ì¹˜ë¥¼ ì €ì¥!!

### â€¢ static files serving  
â€£ í´ë” ì „ì²´ë¥¼ ë¸Œë¼ìš°ì €ì—ê²Œ ë…¸ì¶œ ì‹œí‚¨ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.  
-> app.use("/ì£¼ì†Œ", express.static("ì˜¤í”ˆí•  í´ë” ì´ë¦„")); 

### â€¢ ObjectId  
â€£ mongooseì—ì„œë§Œ ê°€ëŠ¥í•œ íƒ€ì…  
-> models/Video.jsì—ì„œ ì“°ê¸° ìœ„í•´ ownerì— type: mongoose.Schema.Types.ObjectIdë¡œ ì‘ì„±  
-> ì—¬ê¸°ì„œ ObjectIdëŠ” db.videos.find({})ë¡œ ë‚˜ì˜¤ëŠ” ownerì˜ íƒ€ì…ìœ¼ë¡œ, videoì™€ userë¥¼ ì—°ê²°ì‹œí‚¤ê¸° ìœ„í•´ ì‚¬ìš©  
(videoì— user(owner) ì •ë³´ ë„£ê¸° ìœ„í•´)  

-> ownerì— reference ì¶”ê°€ : ìœ„ object IDê°€ model userì—ì„œ ì˜¨ë‹¤ê³  ì•Œë ¤ì£¼ëŠ” ê²ƒ  
=> ref: "User"  
-> ì—¬ê¸°ì„œ UserëŠ” models/User.jsì˜ User  

### â€¢ populate  
â€£ videoController.jsì˜ watchì˜ Video.findeByIdì— populate("owner")ì„ ì¶”ê°€í–ˆë”ë‹ˆ, videoì˜ ownerê°€ userì˜ idë§Œì´ ì•„ë‹Œ userì˜ ëª¨ë“  ì •ë³´ë¥¼ ë³´ì—¬ì¤€ë‹¤.  
(mongooseê°€ videoë¥¼ ì°¾ê³ , ê·¸ ì•ˆì—ì„œ ownerë„ ì°¾ìŒ)  
-> mongooseëŠ” ownerê°€ object IDì¸ê±¸ ì•Œê³ , idê°€ Userì—ì„œ ì˜¨ ê±¸ ì•Œê³ ìˆìŒ  
=> populateë¡œ ì—¬ëŸ¬ ì¤„ì˜ ì½”ë“œë¥¼ í•œ ì¤„ë¡œ ì¤„ì—¬ë²„ë¦¼!! mongoose relationship!! ì§±  

### â€¢ isModified
-> videoë¥¼ uploadí•˜ë©´ save()ê°€ ì‹¤í–‰ë˜ì–´ ë¹„ë°€ë²ˆí˜¸ë¥¼ hashí•¨  
(ì´ë¯¸ hashê°€ ë˜ì–´ìˆëŠ” passwordë¥¼ ë˜ hashí•¨   
-> ê·¸ë˜ì„œ video ì—…ë¡œë“œí•œ í›„ ë¡œê·¸ì•„ì›ƒí•˜ê³  ë‹¤ì‹œ ë¡œê·¸ì¸í•˜ë©´ ë¡œê·¸ì¸ì´ ì•ˆë¨!)  
-> User.jsì— if(this.isModified("password")) ì¡°ê±´ ì¶”ê°€í•´ì„œ passwordê°€ ë³€ê²½ë  ë•Œë§Œ hashë˜ë„ë¡ í•¨  
=> ì´ê±°ë¡œ ë¬¸ì œ í•˜ë‚˜ í•´ê²°!  

### â€¢ ë¬¸ì œ í•´ê²°
-> video ìˆ˜ì •ê³¼ ì‚­ì œë¥¼ video ì˜¬ë¦° userë§Œ ê°€ëŠ¥í•˜ê²Œ í•˜ê³ ì‹¶ìŒ!  
-> videoController.jsì˜ getEditì— ë¡œê·¸ì¸í•œ user idì™€ video ì—…ë¡œë“œí•œ ownerê°€ ê°™ì•„ì•¼ í•œë‹¤ëŠ” ì¡°ê±´ë¬¸ ì¶”ê°€  
-> ì¡°ê±´ë¬¸ì€ ì‹¤í–‰ ë˜ì§€ë§Œ user idì™€ ownerê°€ ê°™ì€ë°ë„ elseë¬¸ì´ ì‹¤í–‰ ë˜ì–´ë²„ë¦¼  
-> ì½˜ì†” ì°ì–´ë³´ë©´ ë‘ ê°œê°€ íƒ€ì…ì´ ë‹¤ë¥´ë‹¤ëŠ” ê±¸ í™•ì¸ ê°€ëŠ¥ (ownerì€ objectì¸ë° user ifëŠ” string)  
-> ê·¸ë˜ì„œ Stringìœ¼ë¡œ ë‘˜ ë‹¤ ê°ì‹¸ì¤˜ì„œ stringìœ¼ë¡œ ë§Œë“¦   
-> ì´ê±°ë¡œ ë¬¸ì œ ë‘˜ í•´ê²°!! (postEditê³¼ deleteVideoì—ë„ ì¶”ê°€í•¨)  
=> ì—¬ê¸°ì—ëŠ” populate ì¶”ê°€ ì•ˆ í•œ ì´ìœ  : ëª¨ë“  user ì •ë³´ê°€ í•„ìš”í•˜ì§€ ì•Šê³  idë§Œ í•„ìš”í•´ì„œ  


### â€¢ webpack  
``` npm i webpack webpack-cli -D```  
â€£ webpackì—ëŠ” ì†ŒìŠ¤ íŒŒì¼ë“¤ì´ ìˆê³ , ìš°ë¦¬ íŒŒì¼ë“¤ì„ ë°”ê¿”ì¤€ë‹¤.  
ex) JSë¥¼ ì˜›ë‚  JS ì½”ë“œë¡œ ë°”ê¿”ì¤Œ  
â€£ ëŒ€ë¶€ë¶„ì˜ í”„ë ˆì„ì›Œí¬ë“¤ì€ ìì²´ webpack ì„¤ì •ì´ ë‚´ì œë˜ì–´ ìˆì–´ì„œ ì›¬ë§Œí•˜ë©´ webpack ë‹¤ë£° ì¼ ê±°ì˜ ì•„ì˜ˆ ì—†ì„ ê±°!!

â€£ entry : ìš°ë¦¬ê°€ ì²˜ë¦¬í•˜ê³ ì (ë³€ê²½í•˜ê³ ì) í•˜ëŠ” íŒŒì¼ë“¤  
â€£ output: ê²°ê³¼ë¬¼  
â€£ filename : ìš°ë¦¬ ê²°ê³¼ë¬¼ì´ ë  íŒŒì¼ ì´ë¦„  
â€£ path: ìš°ë¦¬ ê²°ê³¼ë¬¼ì´ ì €ì¥ë  ê²½ë¡œ (ì ˆëŒ€ê²½ë¡œì—¬ì•¼ í•¨!)  
â€£ watch : ë³€ê²½ì‚¬í•­ ë°œìƒí•´ë„ ìë™ìœ¼ë¡œ refresh, compile í•´ì¤Œ!  
(ë§¤ë²ˆ assets íŒŒì¼ ì‚­ì œí•˜ê³  npm run assets ì‹¤í–‰í•˜ëŠ” ë²ˆê±°ë¡œì›€ í•´ê²°)   
-> ì´ê²Œ ì˜ë¯¸í•˜ëŠ” ê±´ ì½˜ì†”ì€ ê¼­ ë™ì‹œì— ë‘ ê°œ ì‹¤í–‰í•´ì•¼ í•œë‹¤ëŠ” ê²ƒ!! (backend n frontend)  
â€£ clean : trueí•˜ë©´ ouput í´ë”ë¥¼ build ì „ì— clean í•´ì¤Œ

### â€¢ rules  
â€£ ìš°ë¦¬ê°€ ê°ê°ì˜ íŒŒì¼ ì¢…ë¥˜ì— ë”°ë¼ ì–´ë–¤ ì „í™˜ì„ í• ê±´ì§€ ê²°ì •í•˜ëŠ” ê²ƒ

### â€¢ webpack.config.js 
â€£ ëª¨ë“  webpack.config.js íŒŒì¼ì€ ë™ì¼í•œ êµ¬ì¡° ê°€ì§  
-> ì—¬ê¸°ê¹Œì§€ëŠ” ì™„ë²½íˆ ì´í•´í•˜ê³  ìˆì–´ì•¼ í•¨  
```
module.exports = {
    entry: "./src/client/js/main.js", 
    output: {
        filename: "main.js",
        path: path.resolve(__dirname, "assets", "js"),  
    },
    module: {
        rules: [
            {
                test: /\.js$/,
                use: {}]],
                    },
                },
            },
        ],
    },
};
```
=> ì´ íŒŒì¼ì´ í•˜ëŠ” ì¼ì€ entryì˜ íŒŒì¼ì„ ê°€ì§€ê³  ì½”ë“œì— ë”°ë¼ ë³€í˜•  
-> webpackì´ ì–´ë–»ê²Œ ì²˜ë¦¬í• ì§€ ì•Œë ¤ì¤˜ì•¼ í•˜ëŠ”ë°, ê·¸ê±¸ ruleì—ì„œ ì²˜ë¦¬    

### â€¢ MiniCssExtractPlugin  
â€£ í•´ë‹¹ ì½”ë“œë¥¼ ë‹¤ë¥¸ íŒŒì¼ë¡œ ë¶„ë¦¬ì‹œì¼œì¤€ë‹¤.  
( cssë¥¼ ì¶”ì¶œí•´ì„œ ë³„ë„ì˜ íŒŒì¼ë¡œ ë§Œë“¤ì–´ì¤Œ )  
â€£ outputì˜ pathì— ë”°ë¼ íŒŒì¼ì˜ ì €ì¥ìœ„ì¹˜ê°€ ì €ì¥ëœë‹¤.  


### â€¢ ë¬¸ì œ í•´ê²°  
-> webpack.config.jsì— watch: true ì¶”ê°€í•´ì„œ npm run assets (í”„ë¡ íŠ¸)ì´ ìë™ìœ¼ë¡œ refresh, compileë˜ê²Œ í•´ì¤¬ëŠ”ë°, ë°±ì—”ë“œë„ ê°™ì´ ì¬ì‹œì‘ ë˜ì–´ë²„ë¦¼!  
(nodemonì´ íŒŒì¼ì„ ì €ì¥í•˜ëŠ” ì¤„ ì•Œê³  ì¬ì‹œì‘í•˜ëŠ” ê±°!!)   
-> í•´ê²° ë°©ë²• ë‘ ê°€ì§€ ìˆìŒ
1. package.jsonì— ëª…ë ¹ë¬¸ì„ ì‘ì„±í•´ì„œ ì‹¤í–‰í•˜ëŠ” ê²ƒ
2. ì„¤ì •íŒŒì¼ì„ ìƒì„±í•˜ëŠ” ê²ƒ  
-> 1ë²ˆì€ ë„ˆë¬´ ê¸¸ì–´ì§ˆ ê²ƒ ê°™ìœ¼ë‹ˆ 2ë²ˆ ì±„íƒ  
-> nodemon.json íŒŒì¼ ìƒì„±í•´ì„œ ì•„ë˜ ì½”ë“œ ì¶”ê°€
```
  "ignore": ["webpack.config.js", "src/client/*", "assets/*],
  "exec": "babel-node src/init.js"
```
-> package.jsonì˜ scripts: devë¥¼ nodemonë§Œ í˜¸ì¶œí•˜ë„ë¡ ë³€ê²½  
(= nodemonì´ ìë™ì ìœ¼ë¡œ nodemon.jsonì„ í˜¸ì¶œ)  
=> í•´ê²°!!  

(package.jsonì˜ scripts: assetsë„ webpackë§Œ ì¨ë„ ì˜ ì‘ë™í•¨!  
-> webpack.config.jsíŒŒì¼ì´ webpack ì‹¤í–‰ë  ë•Œ ê¸°ë³¸ì ìœ¼ë¡œ ì°¾ëŠ” ì„¤ì •íŒŒì¼ì´ë¼)  

### â€¢ ì½”ë©˜íŠ¸  
â€£ // ì´ê±°ëŠ” ì†ŒìŠ¤ì½”ë“œì—ì„œ ë³¼ ìˆ˜ ìˆìŒ  
(ì´ ì½”ë©˜íŠ¸ëŠ” pugì—ì„œ ì½”ë©˜íŠ¸ ì²˜ë¦¬ë˜ì–´ htmlì½”ë©˜íŠ¸ë¡œ ë°”ë€œ)  
-> ëª¨ë“  ì‚¬ëŒì—ê²Œ ë³´ì—¬ì§  
(=> ë¸Œë¼ìš°ì €ì—ì„œëŠ” ë³´ì´ì§€ ì•Šì§€ë§Œ ì›¹ì‚¬ì´íŠ¸ë¥¼ inspectí•˜ë©´ ë³¼ ìˆ˜ ìˆìŒ)
â€£ //- ì´ê±°ëŠ” í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë³¼ ìˆ˜ ì—†ìŒ  
-> pug íŒŒì¼ì— ì•¡ì„¸ìŠ¤ë¥¼ ê°€ì§€ê³  ìˆëŠ” ì‚¬ëŒì—ê²Œ ë³´ì—¬ì§ 

### â€¢ pause  
â€£ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¤‘ í•˜ë‚˜ë¡œ, ì •ì§€ì‹œí‚¤ëŠ” ê±°  
(playë„ ìˆìŒ)  

### â€¢ metadata (video objectì˜ event)  
â€£ video ë¹¼ê³  ëª¨ë“  ê²ƒ  
-> ë¹„ë””ì˜¤ì˜ ì†Œë¦¬, ê°€ë¡œì„¸ë¡œ í¬ê¸°, ë“± ì›€ì§ì´ëŠ” ì´ë¯¸ì§€ë¥¼ ì œì™¸í•œ ëª¨ë“  ê²ƒ  

### â€¢ API
â€£ í”„ë¡ íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œê°€ ì„œë²„ë¥¼ í†µí•´ í†µì‹ í•˜ëŠ” ë°©ë²•  

### â€¢ data Attribute  
â€£ data-ë¡œ ì‹œì‘í•˜ëŠ” ì†ì„±  
-> ì–´ë–¤ ê²ƒì´ë“  ì €ì¥ ê°€ëŠ¥ (HTML specificationê³¼ë„ ë¬¸ì œ X)  
â€£ ìë°”ìŠ¤í¬ë¦½íŠ¸ ë°ì´í„°ì— ì‰½ê²Œ ì ‘ê·¼ ê°€ëŠ¥  
â€£ HTML element ì €ì¥ ê°€ëŠ¥  

### â€¢ ë¬¸ì œ í•´ê²°  
-> video ëë‚¬ì„ ë•Œ fetch ì´ìš©í•´ ë°±ì—”ë“œì— ìš”ì²­ ë³´ë‚´ëŠ”ë° ê²Œì† pendingìœ¼ë¡œ ëœ¸ (serverë‘ Controller, Router ë‹¤ ì‘ì„±í•¨!)  
-> ì´ìœ  : return res.status(404); ì´ë ‡ê²Œë§Œ ì¨ì„œ (ì‘ë‹µì— ìƒíƒœ ì½”ë“œë¥¼ ì¶”ê°€ë§Œ í•´ì„œ ì•„ë¬´ê²ƒë„ return í•˜ì§€ ì•ŠìŒ)   
-> status ëŒ€ì‹  sendStatusì‚¬ìš©  
(return res.sendStatus(404);)   
ì´ë ‡ê²Œ í•´ì•¼ ì—°ê²° ëë‚¼ ìˆ˜ ìˆìŒ!  
-> status 200 ë°›ìŒ í•´ê²°!! 

### â€¢ status()ê³¼ sendStatus() 
â€£ status() : render()í•˜ê¸° ì „ì— ìƒíƒœ ì½”ë“œë¥¼ ì •í•  ìˆ˜ ìˆëŠ” ê²ƒ  
â€£ sendStatus() : ìƒíƒœ ì½”ë“œë¥¼ ë³´ë‚´ê³  ì—°ê²°ì„ ëë‚´ëŠ” ê²ƒ  

### â€¢ MediaRecorder  
â€£ ë¹„ë””ì˜¤ë“  ì˜¤ë””ì˜¤ë“  ë…¹í™”í•˜ê³  ì‹¶ì€ ëª¨ë“  ê±¸ ë…¹í™”  
â€£ dataavailable event : ì €ì¥ëœ ë°ì´í„°ì˜ ìµœì¢… video ë‹´ìŒ  
â€£ stream : ìš°ë¦¬ê°€ ì–´ë”˜ê°€ì— ë„£ì–´ë‘˜ 0ê³¼ 1ë¡œ ì´ë£¨ì–´ì§„ ë°ì´í„°ë¥¼ ì˜ë¯¸  
â€£ createObjectURL : íŒŒì¼ì„ ë¯¸ë¦¬ë³´ê±°ë‚˜ ë³´ê³  ì‹¶ì„ ë•Œì—ëŠ” í•´ë‹¹ URLì´ í•„ìš”í•´ì„œ, ì´ê±¸ í†µí•´ videoì— ì ‘ê·¼  
-> ì›¹ì‚¬ì´íŠ¸ ìƒì— ì¡´ì¬í•˜ëŠ” URLì²˜ëŸ¼ ë³´ì´ì§€ë§Œ ì‹¤ì œë¡œëŠ” X  
-> ë‹¨ìˆœíˆ ë¸Œë¼ìš°ì €ì˜ ë©”ëª¨ë¦¬ë§Œ ê°€ë¦¬í‚´(íŒŒì¼ ê°€ë¦¬í‚¤ëŠ” URL). ë°±ì—”ë“œì— ì—†ê³ , ê»ë‹¤ í‚¤ë©´ ì¦ë°œ  

### â€¢ FFmpeg  
â€£ ì»´í“¨í„°ì— ì„¤ì¹˜í•  ìˆ˜ ìˆëŠ” ì†Œí”„íŠ¸ì›¨ì–´  
â€£ ë¹„ë””ì˜¤ë¥¼ ì—¬ëŸ¬ê°€ì§€ í¬ë§·ê³¼ í™”ì§ˆë¡œ ì¸ì½”ë”©  
â€£ ì˜¤ë””ì˜¤ ì¶”ì¶œ, ì˜¤ë””ì˜¤ í˜•ì‹ ë³€ê²½, ë¹„ë””ì˜¤ë¡œ ìŠ¤í¬ë¦°ìƒ·, gifë¡œ ë§Œë“¤ê¸° ë“±ë“± ê°€ëŠ¥  
â€£ ë³´í†µ ë°±ì—”ë“œì—ì„œ ì‚¬ìš©í•˜ì§€ë§Œ webassembly ë•ë¶„ì— í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ì‚¬ìš© ê°€ëŠ¥

### â€¢ WebAssembly 
â€£ ê¸°ë³¸ì ìœ¼ë¡œ ì›¹ì‚¬ì´íŠ¸ê°€ ë§¤ìš° ë¹ ë¥¸ ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆê²Œ í•´ì¤Œ (ê°œë°©í˜• í‘œì¤€)

### â€¢ ffmpeg.wasm  
â€£ ìœ„ ë‘ ê°œ í•©ì¹¨  
â€£ ë¹„ë””ì˜¤ë¥¼ ë³€í™˜í•˜ê¸° ìœ„í•´ ì‚¬ìš©ìì˜ ì»´í“¨í„° ì‚¬ìš©  
â€£ ì‚¬ìš©ìì˜ ë¸Œë¼ìš°ì €ì—ì„œ ë¹„ë””ì˜¤ë¥¼ ë³€í™˜  
(ì‚¬ìš©ì(ì»´í“¨í„°)ì˜ ì²˜ë¦¬ëŠ¥ë ¥ ì‚¬ìš©)  
â€£ ë¹„ë””ì˜¤ ì°ê³  Webm íŒŒì¼ë¡œ ì €ì¥í•˜ë©´ ì´ê±¸ mp4ë¡œ ë³€í™˜í•˜ê³  ì¸ë„¤ì¼ ì¶”ì¶œ
(ëª¨ë“  ê¸°ê¸°ë“¤ì´ webm ì´í•´í•˜ì§€ ëª»í•´ì„œ ë³€í™˜í•˜ëŠ” ê±°) 
```
npm install @ffmpeg/ffmpeg @ffmpeg/core
```

### â€¢ ArrayBuffer  
â€£ ArrayBufferì€ raw binary dataë¥¼ ë‚˜íƒ€ë‚´ëŠ” object  
=> ìš°ë¦¬ ì˜ìƒì„ ë‚˜íƒ€ë‚´ëŠ” bytesì˜ ë°°ì—´  
â€£ Unit8Arrayë¡œë¶€í„° blobì„ ë§Œë“¤ ìˆ˜ëŠ” ì—†ì§€ë§Œ ArrayBufferë¡œëŠ” ë§Œë“¤ ìˆ˜ ìˆìŒ  
-> mp4Fileì„ ì½˜ì†”ì— ì°ì–´ë³´ë©´ ì—„ì²­ ê¸´ ìˆ«ì ë°°ì—´ë“¤ì´ ë‚˜ì˜´ (ì´ ë°°ì—´ë“¤ì€ ì‹¤ì œ íŒŒì¼(videoFile) ë‚˜íƒ€ëƒ„!!)  
-> ì´ ë°°ì—´ì˜ raw data, ì¦‰ binary dataì— ì ‘ê·¼í•˜ë ¤ë©´ mp4File.bufferì„ ì‚¬ìš©í•´ì•¼ í•¨  
â€£ buffer : ArrayBufferì„ ë°˜í™˜   
â€£ blobì€ ë°°ì—´ ì•ˆì— ë°°ì—´ë“¤ì„ ë°›ì„ ìˆ˜ ìˆìŒ  
(-> recorder.jsì—ì„œ handleStart í•¨ìˆ˜ì˜ createObjectURL(event.data)ë¡œ ìƒê¸´ dataê°€ blobì„!)

### â€¢ express-flash  
â€£ ì‚¬ìš©ìì—ê²Œ flash messageë¥¼ ë‚¨ê¸¸ ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” middleware  
â€£ ì´ ë©”ì‹œì§€ëŠ” sessionì— ê·¼ê±°í•˜ê¸° ë•Œë¬¸ì— í•œ ì‚¬ìš©ìë§Œ ë³¼ ìˆ˜ ìˆìŒ  
(redirectë¥¼ í•  ë•Œ ì‚¬ìš©ìì—ê²Œ ì´ìœ ë¥¼ ì„¤ëª…í•˜ê³  ì‹¶ìœ¼ë©´ ë©”ì‹œì§€ ë³´ë‚¼ ìˆ˜ ìˆìŒ)  
â€£ ì¼íšŒì„± ë©”ì‹œì§€ì„!!  
(=> flash ë¯¸ë“¤ì›¨ì–´ëŠ” messagesë¼ê³  í•˜ëŠ” localsë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ì¤Œ)  

### â€¢ JSON  
â€£ JSON.stringify({text: "i like it", rating: "5"})  
-> "{/"text/":/"i like it/",'"rating/":/"5/"}"  
(ë°ì´í„°ë¥¼ ë°›ì•„ì„œ stringìœ¼ë¡œ ë°”ê¿”ì¤Œ)  
â€£ JSON.parse("{/"text/":/"i like it/",'"rating/":/"5/"}")    
-> {text: "i like it", rating: "5"}  
(backendì—ì„œëŠ” ì´ stringì„ ë°›ì•„ì„œ JS objectë¡œ ë°”ê¿”ì¤Œ)

  
